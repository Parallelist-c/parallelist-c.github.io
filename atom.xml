<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://parallelist-c.github.io</id>
    <title>Parallelist</title>
    <updated>2021-01-09T02:16:13.424Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://parallelist-c.github.io"/>
    <link rel="self" href="https://parallelist-c.github.io/atom.xml"/>
    <subtitle>æµ…ã„å¤¢ã ã‹ã‚‰ èƒ¸ã‚’ã¯ãªã‚Œãªã„</subtitle>
    <logo>https://parallelist-c.github.io/images/avatar.png</logo>
    <icon>https://parallelist-c.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Parallelist</rights>
    <entry>
        <title type="html"><![CDATA[Quiz 0107 Summary]]></title>
        <id>https://parallelist-c.github.io/post/quiz-0107-summary/</id>
        <link href="https://parallelist-c.github.io/post/quiz-0107-summary/">
        </link>
        <updated>2021-01-08T13:22:46.000Z</updated>
        <content type="html"><![CDATA[<h1 id="t1-word">T1 word</h1>
<h2 id="description">Description</h2>
<p>ä½ æœ‰ä¸€ä¸ªç”±å°å†™å­—æ¯ç»„æˆçš„é•¿åº¦ä¸º n çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸€æ­¥ä½ è¦æ‰¾åˆ°å®ƒçš„å­ä¸²ä¸­æœ€çŸ­çš„é‡å¤å—ï¼ˆä¸€ä¸ªé‡å¤å—ç”±ä¸€ä¸ªå­—ç¬¦ä¸²ä¸è‡ªèº«è¿æ¥è€Œæˆï¼‰ã€‚å¦‚æœæœ‰å¤šäºä¸€ä¸ªï¼Œä½ å¿…é¡»é€‰æ‹©æœ€å·¦è¾¹çš„é‚£ä¸ªã€‚ä½ è¦å°†é‚£ä¸ªå½¢å¦‚ XX(X - æŸä¸ªå­—ç¬¦ä¸²)çš„é‡å¤å—æ›¿æ¢æˆ Xï¼Œå³åˆ é™¤å…¶ä¸­çš„ä¸€ä¸ª Xã€‚é‡å¤ä»¥ä¸Šæ­¥éª¤ç›´åˆ°å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨é‡å¤å—ã€‚<br>
è¾“å‡ºæœ€ç»ˆçš„å­—ç¬¦ä¸²ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">n\leq 5\times 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>åˆ¤æ–­ä¸²ä¸­ä»»æ„ä½ç½®çš„é‡å¤å—é™¤äº†å“ˆå¸Œè²Œä¼¼ä¹Ÿæ²¡æœ‰åˆ«çš„æ–¹æ³•ã€‚SAM å•Š exkmp å•Š ACAM å•Šéƒ½æŸæ‰‹æ— ç­–ã€‚<br>
ä½†æ˜¯æ‰¾æ‰€æœ‰çš„é‡å¤å—æœ‰ä¸€ä¸ªç»å…¸çš„ trick ï¼šæšä¸¾å¯èƒ½çš„é‡å¤ä¸²é•¿åº¦ len ï¼Œåœ¨åŸå­—ç¬¦ä¸²ä¸­æ¯éš” len æ’æ ‡ï¼Œæ¯”è¾ƒç›¸é‚»ä¸¤ä¸ªæ ‡çš„ lcp+lcs ä¸ len çš„å¤§å°ï¼Œå³å¯åˆ¤æ–­æ­¤å¤„æ˜¯å¦å­˜åœ¨é•¿åº¦ä¸º len çš„é‡å¤ä¸²ã€‚æ±‚ç›¸é‚»ä¸¤ä¸ªæ ‡çš„ lcp å’Œ lcs éƒ½å¯ä»¥å“ˆå¸Œ+äºŒåˆ†ã€‚<br>
å¹¶ä¸”è¿™ä¸ª trick æœ‰ä¸ªä¼˜åŠ¿ï¼šæ¯æ¬¡æ‰¾åˆ°çš„é‡å¤ä¸²ä¸€å®šæ˜¯ç›®å‰é•¿åº¦æœ€å°ä¸”èµ·å§‹ä½ç½®æœ€é å·¦çš„ã€‚<br>
æ°å¥½é€‚åˆè¿™é“é¢˜ç›®å‘¢ğŸ¤ã€‚<br>
ä½†æ˜¯æ¯æ¬¡ä¿®æ”¹å®Œè¦åˆ é™¤å•Šï¼Œè¿™ä¸€åˆ é™¤å“ˆå¸Œæ•°ç»„å°±å¾—é‡æ„äº†ã€‚<br>
å¤§ä¸ˆå¤«ã§ã™ ï¼æ¯æ¬¡æ‰¾åˆ° len é•¿åº¦ä¸‹çš„æ‰€æœ‰é‡å¤å—å¹¶ä¸€èµ·é‡æ„ã€‚è¿™æ ·è‡³å¤šé‡æ„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span> æ¬¡ã€‚<br>
å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mi>n</mi><mi>ln</mi><mo>â¡</mo><mi>n</mi><mo>+</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n\log_2{n}\ln{n}+n\sqrt{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.05028em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">int LCP(int p1,int p2){
    int l=1,r=Maxpre,ret=0;
    while(r&gt;=l){
        int mid=l+r&gt;&gt;1;
        if(geth(p1-mid+1,p1)==geth(p2-mid+1,p2)) ret=mid,l=mid+1;
        else r=mid-1;
    }
    return ret;
}
int LCS(int p1,int p2){
    int l=1,r=p2-p1,ret=0;
    while(r&gt;=l){
        int mid=l+r&gt;&gt;1;
        if(geth(p1,p1+mid-1)==geth(p2,p2+mid-1)) ret=mid,l=mid+1;
        else r=mid-1;
    }
    return ret;
}
int main(){

    scanf(&quot;%s&quot;,s+1);
    int n=strlen(s+1);
    p[0]=1;
    for(int i=1;i&lt;=n;++i)
        p[i]=p[i-1]*B,w[i]=1ull*B*(w[i-1]+s[i]-'a'+1);
    for(int len=1;len&lt;=n/2;++len){
        bool flag=0;
        int j=len,k=len&lt;&lt;1;Maxpre=len;
        while(k&lt;=n){
            int lcp=LCP(j,k),lcs=LCS(j,k);
            if(lcp+lcs&gt;len){
                for(int i=j-lcp+1;i&lt;=j-lcp+len;++i)
                    del[i]=len;
                flag=true;Maxpre=lcp; // æ³¨æ„ Maxpre ã€‚è¦é¿å…è¿™æ¬¡çš„ lcs å½±å“åˆ°ä¸‹æ¬¡çš„ lcp ã€‚
            }
            else Maxpre=len;
            j+=len,k+=len;
        }
        if(!flag) continue;
        int cnt=0;
        for(int i=1;i&lt;=n;++i)
            if(del[i]^len) 
                s[++cnt]=s[i],w[cnt]=1ull*B*(w[cnt-1]+s[i]-'a'+1);
        n=cnt;
    }
    for(int i=1;i&lt;=n;++i)
        putchar(s[i]);
    return 0;
}
</code></pre>
<h1 id="t2-dream">T2 dream</h1>
<h2 id="description-2">Description</h2>
<p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„ä»…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ã€‚æœ‰ m æ¬¡æ“ä½œï¼Œæ¯æ¬¡å½¢å¦‚ l r ï¼Œè¦æ±‚å°† s[l:r] å˜ä¸ºå­—å…¸åºæœ€å°çš„å›æ–‡ä¸²ï¼ˆè‹¥æ— è§£åˆ™å¿½ç•¥ï¼‰ã€‚è¾“å‡ºæœ€åçš„å­—ç¬¦ä¸²ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">n\leq 5\times 10^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution-2">Solution</h2>
<p>è€ƒè™‘å°† s[l:r] å˜ä¸ºå›æ–‡ä¸²çš„è¿‡ç¨‹ï¼šæšä¸¾æ¯ä¸ªå­—ç¬¦ï¼Œå‡è®¾æœ‰ d ä¸ªï¼Œé‚£ä¹ˆå°±ä¼šåœ¨å·¦/å³æŒ‡é’ˆå¤„åˆ†åˆ«æ’å…¥ d/2 ä¸ªï¼Œç„¶åå·¦/å³æŒ‡é’ˆå‡å‘ä¸­é—´é æ‹¢ d/2 ï¼›å¦‚æœ d æ˜¯å¥‡æ•°ï¼Œç‰¹åˆ¤åç›´æ¥æ”¾åœ¨ä¸­é—´å³å¯ã€‚<br>
ä¼˜åŒ–ç©ºé—´åœ¨äºåŠ é€Ÿâ€œæ’å…¥â€çš„è¿‡ç¨‹ï¼Œè€Œè¿™ä¸ªæœ¬è´¨ä¸Šå°±æ˜¯åŒºé—´è¦†ç›–ï¼Œæ•…å¯ä»¥è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤ã€‚<br>
å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mn>26</mn><mi>n</mi><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(26n\log_2{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">6</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mclose">)</span></span></span></span> ã€‚</p>
<h2 id="code-2">Code</h2>
<pre><code class="language-cpp">struct node{
    int a[26];
    node(){memset(a,0,sizeof a);}
    node operator +(const node &amp;b)const{
        node ret;
        for(int i=0;i&lt;26;++i)
            ret.a[i]=b.a[i]+a[i];
        return ret;
    }
}t[N&lt;&lt;2];
namespace SEG{
#define mid (l+r&gt;&gt;1)
#define ls p&lt;&lt;1,l,mid
#define rs p&lt;&lt;1|1,mid+1,r
    int tag[N&lt;&lt;2];
    void pushup(int p){
        t[p]=t[p&lt;&lt;1]+t[p&lt;&lt;1|1];
    }
    void setval(int p,int l,int r,int v){
        t[p]=node();
        t[p].a[v]=(r-l+1);
        tag[p]=v;
    }
    void pushdn(int p,int l,int r,int v){
        setval(ls,v),setval(rs,v);tag[p]=-1;
    }
    void build(int p=1,int l=1,int r=n){
        tag[p]=-1;
        if(l==r) return ++t[p].a[s[l]-'a'],void();
        build(ls);build(rs);
        pushup(p);
    }
    void modify(int p,int l,int r,int nl,int nr,int v){
        if(l&gt;=nl&amp;&amp;r&lt;=nr) return setval(p,l,r,v),void();
        if(~tag[p]) pushdn(p,l,r,tag[p]);
        if(mid&gt;=nl) modify(ls,nl,nr,v);
        if(mid&lt; nr) modify(rs,nl,nr,v);
        pushup(p);
    }
    node query(int p,int l,int r,int nl,int nr){
        if(l&gt;=nl&amp;&amp;r&lt;=nr) return t[p];
        if(~tag[p]) pushdn(p,l,r,tag[p]);
        if(mid&gt;=nr) return query(ls,nl,nr);
        else if(mid&lt;nl) return query(rs,nl,nr);
        else return query(ls,nl,mid)+query(rs,mid+1,nr); 
    }
    void print(int p=1,int l=1,int r=n){
        if(l==r){
            for(int i=0;i&lt;26;++i)
                if(t[p].a[i]) {putchar(char(i+'a'));break;}
            return;
        }
        if(~tag[p]) pushdn(p,l,r,tag[p]);
        print(ls),print(rs);
    }
}
using namespace SEG;
int main(){

    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
    scanf(&quot;%s&quot;,s+1);
    build();
    for(int i=1,l,r;i&lt;=m;++i){
        scanf(&quot;%d%d&quot;,&amp;l,&amp;r);
        node sta=query(1,1,n,l,r);
        int L=l,R=r,times=(r-l+1)&amp;1;
        for(int j=0;j&lt;26;++j)
            times-=(sta.a[j]&amp;1);
        if(times) continue;
        for(int j=0;j&lt;26;++j){
            int d=sta.a[j]/2;
            if(d) modify(1,1,n,L,L+d-1,j);
            if(d) modify(1,1,n,R-d+1,R,j);
            L+=d,R-=d;
            if(sta.a[j]&amp;1)
                modify(1,1,n,mid,mid,j);
        }
    }
    print();
    return 0;
}
</code></pre>
<h1 id="t3-word">T3 word</h1>
<h2 id="description-3">Description</h2>
<p>æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n çš„ç”±å°å†™å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ã€‚å®šä¹‰æå¤§è¿ç»­ç›¸åŒçš„å­åºåˆ—ä¸º energy ã€‚å°†ç»™å®šçš„å­—ç¬¦ä¸²é‡æ–°æ’åˆ—ï¼Œæ±‚æœ‰å¤šå°‘ç§ä¸åŒçš„æ’åˆ—æ–¹å¼ä½¿å¾—å®ƒå’ŒåŸå­—ç¬¦ä¸²æœ‰ç›¸åŒæ•°é‡çš„ energy ã€‚å¯¹ 1000003 å–æ¨¡ã€‚<br>
ä¿è¯ energy çš„æ•°é‡ m ä¸å¤šäº 100 ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n\leq 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution-3">Solution</h2>
<p>å…³é”®åˆ‡å…¥ç‚¹å½“ç„¶æ˜¯ energy çš„æ•°é‡é™åˆ¶å•¦ã€‚<br>
è®¾ f[i][j] è¡¨ç¤ºè€ƒè™‘å‰ i ç§å­—ç¬¦ï¼Œå·²ç»ç»„æˆäº† j ä¸ª energy çš„æ–¹æ¡ˆæ•°ï¼›cnt[i] è¡¨ç¤ºç¬¬ i ç§å­—ç¬¦çš„ä¸ªæ•°ï¼›sum[i] è¡¨ç¤º cnt çš„å‰ç¼€å’Œã€‚<br>
æ’å…¥ç¬¬ i+1 ç§å­—ç¬¦æ—¶ï¼Œæ–°å¢çš„ energy çš„æ¥æºæœ‰ä¸¤å¤„â€”â€”ç›´æ¥æ’å…¥äº§ç”Ÿçš„ energy å’Œåˆ†éš”å¼€åŸæœ‰çš„ energy äº§ç”Ÿçš„ energy ã€‚è®¾ j è¡¨ç¤ºåŸæœ‰çš„ energy ï¼Œk è¡¨ç¤ºå½“å‰ç›´æ¥æ’å…¥çš„ energy ï¼Œl è¡¨ç¤ºå› åˆ†éš”è€Œäº§ç”Ÿçš„ energy ã€‚å¯å¾—åˆ°è½¬ç§»æ–¹ç¨‹å¼ä¸º</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>[</mo><mi>j</mi><mo>+</mo><mi>k</mi><mo>+</mo><mi>l</mi><mo>]</mo><mo>=</mo><msub><mi>f</mi><mi>i</mi></msub><mo>[</mo><mi>j</mi><mo>]</mo><mo>Ã—</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><msub><mtext>cnt</mtext><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><mo>Ã—</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><msub><mtext>sum</mtext><mi>i</mi></msub><mo>âˆ’</mo><mi>j</mi></mrow><mi>l</mi></mfrac><mo fence="true">)</mo></mrow><mo>Ã—</mo><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>âˆ’</mo><mi>l</mi></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_{i+1}[j+k+l]=f_{i}[j]\times \binom{\text{cnt}_{i+1}-1}{k-1}\times\binom{\text{sum}_i-j}{l}\times\binom{j+1}{k-l}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">cnt</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">sum</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span><span style="top:-3.6770000000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p>
<p>è€ƒè™‘è½¬ç§»æ–¹ç¨‹å¼çš„æ„ä¹‰ã€‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><msub><mtext>cnt</mtext><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{\text{cnt}_{i+1}-1}{k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2984390000000001em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.895108em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cnt</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.20252142857142857em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> è¡¨ç¤ºç¬¬ i+1 ç§å­—ç¬¦ç»„æˆ k ä¸ª energy çš„æ–¹æ¡ˆæ•°ï¼Œç„¶åæ˜¯ä¸ªç»å…¸éš”æ¿æ³•ï¼›è€ƒè™‘æ’å…¥çš„å…·ä½“æƒ…å†µï¼šæœ€å¼€å¤´ä»¥åŠ j ä¸ª energy çš„æœ«å°¾æ’å…¥æ—¶éƒ½ä¸ä¼šé€ æˆåˆ†éš”ï¼Œè¿™éƒ¨åˆ†çš„æ–¹æ¡ˆæ•°ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>âˆ’</mo><mi>l</mi></mrow></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{j+1}{k-l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.308995em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.905664em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> ï¼Œå…¶ä½™çš„ä½ç½®æ’å…¥æ—¶ä¼šé€ æˆå› åˆ†éš”è€Œäº§ç”Ÿçš„ energy ï¼Œè¿™éƒ¨åˆ†çš„æ–¹æ¡ˆæ•°ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><msub><mtext>sum</mtext><mi>i</mi></msub><mo>âˆ’</mo><mi>j</mi></mrow><mi>l</mi></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{\text{sum}_i-j}{l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.255674em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9056639999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sum</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span> ã€‚<br>
å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>+</mo><mn>26</mn><msup><mi>m</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n+26m^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">6</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ã€‚</p>
<h2 id="code-3">Code</h2>
<pre><code class="language-cpp">const int N=1e5+5,M=1e2+5,Mod=1e6+3;
using namespace std;
char s[N];
int f[M],g[M],sum[26],cnt[26],c[N][M];
inline int Plus(int a,int b){return a+b&gt;=Mod?a+b-Mod:a+b;}
int main(){

    scanf(&quot;%s&quot;,s+1);
    int n=strlen(s+1),tot=0;
    for(int i=1;i&lt;=n;++i)
        tot+=(s[i]!=s[i-1]);
    for(int i=1;i&lt;=n;++i)
        ++cnt[s[i]-'a'];
    sum[0]=cnt[0];
    for(int i=1;i&lt;26;++i)
        sum[i]=sum[i-1]+cnt[i];
    c[0][0]=c[1][0]=1;
    for(int i=1;i&lt;=n;++i,c[i][0]=1)
    for(int j=1;j&lt;=i&amp;&amp;j&lt;=tot;++j)
        c[i][j]=Plus(c[i-1][j-1],c[i-1][j]);
    f[bool(sum[0])]=1;
    for(int i=1;i&lt;26;++i){
        if(!cnt[i]) continue;
        memset(g,0,sizeof g);
        for(int j=0;j&lt;=tot&amp;&amp;j&lt;=sum[i-1];++j)
        for(int k=1;j+k&lt;=tot&amp;&amp;k&lt;=cnt[i];++k)
        for(int l=0;j+k+l&lt;=tot&amp;&amp;l&lt;=k;++l){
            int now=1ll*f[j]*c[j+1][k-l]%Mod*c[cnt[i]-1][k-1]%Mod*c[sum[i-1]-j][l]%Mod;
            g[j+k+l]=Plus(g[j+k+l],now);
        }
        for(int j=0;j&lt;=tot;++j) f[j]=g[j];
    }
    printf(&quot;%d\n&quot;,f[tot]);
    return 0;
}
</code></pre>
<h1 id="analysis">Analysis</h1>
<p>T1 å¤±è¯¯åœ¨äºå®Œå…¨ä¸è®°å¾— trick äº†ã€‚åšé¢˜é‡è¦å¢åŠ ã€‚</p>
<p>T2 å¤±è¯¯åœ¨äºæœªæƒ³æ¸…æ¥šè´¸ç„¶åŠ¨æ‰‹ã€‚è§‰å¾—ç»´æŠ¤åºåˆ—ç”¨ splay å†å¥½ä¸è¿‡äº†ï¼Œè€Œä¸”ä¼¼ä¹åªéœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹æ‰¾åˆ°å½“å‰ä½ç½®åœ¨æœ€ç»ˆå›æ–‡ä¸²ä¸­æ˜¯ä»€ä¹ˆå­—æ¯ï¼Œå†æ‰“ä¸ªæ ‡è®°å°±è¡Œäº†ã€‚ä¸è¦æµ…å°è¾„æ­¢å•Š QAQ ğŸ˜­  è¿™ä¸ªæ ‡è®°çœŸçš„å¯ä»¥ä¸‹ä¼ å—ï¼Ÿï¼<strong>ç”¨æ•°æ®ç»“æ„ç»´æŠ¤æ—¶ä¸ä»…è¦çŸ¥é“æ‰“æ‡’æ ‡è®°ï¼Œæ›´è¦æƒ³æ¸…æ¥šæ‡’æ ‡è®°èƒ½ä¸èƒ½ä¸‹ä¼ ï¼Œæ€ä¹ˆä¸‹ä¼ </strong>ã€‚</p>
<p>T3 è€ƒè¯•çš„æ—¶å€™å®Œå…¨æ²¡æƒ³ï¼Œè€ƒåä¹Ÿæ²¡æœ‰æ€è·¯ã€‚ä»å­—ç¬¦å’Œæå¤§è¿ç»­ç›¸åŒå­—ç¬¦ä¸²å…¥æ‰‹è®¾ç½®çŠ¶æ€çš„æ€æƒ³å¾ˆå¦™ã€‚æšä¸¾çš„æ—¶å€™è¦å­¦ä¼š<strong>æšä¸¾æ®µ</strong>çš„æ¦‚å¿µï¼Œè€Œä¸è¦å±€é™äºç‚¹ã€‚ç‚¹åˆ°<strong>æ®µ</strong>åªéœ€è¦ä¸€ä¸ªéš”æ¿æ³•ï¼Œè€Œæ®µå¯ä»¥çœå»è¶…çº§å¤šçš„è®¨è®ºï¼Œç”¨èµ·æ¥å¾ˆå®ç”¨ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[CF700E Cool Slogans è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/cf700e-cool-slogans-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/cf700e-cool-slogans-jie-ti-bao-gao/">
        </link>
        <updated>2021-01-07T09:23:29.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸² s ï¼Œè¦æ±‚æ„é€ å­—ç¬¦ä¸²åºåˆ— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><msub><mi>s</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">s_1,s_2,\cdots,s_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œæ»¡è¶³ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ€</mi><mi>i</mi><mo>âˆˆ</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">\forall i\in[1,k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ s çš„å­ä¸²ï¼Œä¸” <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ€</mi><mi>i</mi><mo>âˆˆ</mo><mo>[</mo><mn>2</mn><mo separator="true">,</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">\forall i\in[2,k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span>ï¼Œ éƒ½æœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸­è‡³å°‘å‡ºç°äº†ä¸¤æ¬¡ï¼ˆå¯ä»¥æœ‰é‡å éƒ¨åˆ†ï¼‰ã€‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä¸èƒ½ä¸ºç©ºã€‚æ±‚æœ€å¤§çš„ k å€¼ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mn>2</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">1\leq n\leq 2\times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>æœ‰çš„æ—¶å€™åšé¢˜æ²¡æœ‰çµæ„Ÿï¼Œç¿»é¢˜è§£æ—¶ä¼šå‘ç°é¢˜è§£å…ˆç»™å®šäº†å‡ æ¡ååˆ†æ˜¾ç„¶çš„ç»“è®ºï¼Œç„¶åæ€è·¯å°±æ‰“å¼€äº†ã€‚ç»“è®ºè™½ç„¶æ˜¾ç„¶ï¼Œä½†é—®é¢˜å°±åœ¨äºè‡ªå·±æƒ³ä¸åˆ°ï¼Œæˆ–è€…è¯´ï¼Œä¸æ˜ç™½è‡ªå·±ä¸ºä»€ä¹ˆè¦å¾€é‚£æ–¹é¢æƒ³ğŸ˜“ã€‚</p>
<p>æ¯”å¦‚è¿™é“é¢˜ã€‚æœ‰ä¸€ä¸ªå¾ˆå¥½è¯æ˜çš„ç»“è®ºå°±æ˜¯ï¼š</p>
<blockquote>
<p>å­˜åœ¨è‡³å°‘ä¸€ç§æ–¹æ¡ˆï¼Œæ»¡è¶³ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ€</mi><mi>i</mi><mo>âˆˆ</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">\forall i\in[1,k-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> çš„åç¼€ã€‚</p>
</blockquote>
<p>è¯æ˜å¯ä»¥è¿™æ ·è€ƒè™‘ï¼šå¦‚æœ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> åé¢è¿˜å¤šäº†ä¸€æ®µï¼Œåˆ å»è¿™æ®µä½¿å¾— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> æˆä¸ºåç¼€åå¯¹äºåºåˆ—å¹¶æ— å½±å“ã€‚</p>
<p>äºæ˜¯æœ€ç»ˆçš„åºåˆ—ä¸€å®šæ˜¯ parent æ ‘ä¸Šçš„ä¸€æ¡é“¾ä¸Šé€‰è‹¥å¹²ä¸ªã€‚ä¼¼ä¹å¯ä»¥ç”¨æ ‘å½¢ dp æ¥å¤„ç†ã€‚è®¾ f[u] è¡¨ç¤ºç¬¬ i ä¸ªèŠ‚ç‚¹åŠå…¶ç¥–å…ˆå¯ä»¥æ„æˆçš„æœ€é•¿åºåˆ—çš„é•¿åº¦ã€‚<br>
è€ƒè™‘è½¬ç§»çš„æ¡ä»¶ã€‚å¯¹äº u åŠå…¶ç¥–å…ˆèŠ‚ç‚¹ v ï¼Œè‹¥ v åœ¨æŸä¸ª u ä»£è¡¨çš„å­—ç¬¦ä¸²ä¸­å‡ºç°ä¸¤æ¬¡åˆ™æ‰§è¡Œ f[u]=f[v]+1 ï¼Œå¦åˆ™æ‰§è¡Œ f[u]=f[v] ã€‚é—®é¢˜è½¬åŒ–ä¸ºäº†å¦‚ä½•åˆ¤å®š v åœ¨æŸä¸ª u ä»£è¡¨çš„å­—ç¬¦ä¸²ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚<br>
èŠ‚ç‚¹ u æœ‰ä¸æ­¢ä¸€ä¸ª endpos éš¾é“éœ€è¦ä¸€ä¸€æšä¸¾å†åˆ†åˆ«åˆ¤å®šå—ï¼Ÿæˆ‘ä»¬å…ˆé’¦å®šåˆ¤å®š u çš„ç¬¬ä¸€ä¸ªendpos ä½ç½® p ï¼Œ é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>p</mi><mo>âˆ’</mo><mi>a</mi><mo>[</mo><mi>u</mi><mo>]</mo><mi mathvariant="normal">.</mi><mi>l</mi><mo>+</mo><mi>a</mi><mo>[</mo><mi>v</mi><mo>]</mo><mi mathvariant="normal">.</mi><mi>l</mi><mo separator="true">,</mo><mi>p</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">[p-a[u].l+a[v].l,p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mclose">]</span></span></span></span> èŒƒå›´å†…æŸ¥è¯¢ v çš„ endpos æ•°ç›®ï¼Œè¿™ä¸ªèŒƒå›´æ˜¯å±äº <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>p</mi><mo>âˆ’</mo><mi>a</mi><mo>[</mo><mi>u</mi><mo>]</mo><mi mathvariant="normal">.</mi><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>p</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">[p-a[u].l+1,p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mclose">]</span></span></span></span> çš„ï¼Œå³å¯¹äºæ¯ä¸ªç»“æŸèŠ‚ç‚¹ p ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>[</mo><mi>p</mi><mo>âˆ’</mo><mi>a</mi><mo>[</mo><mi>u</mi><mo>]</mo><mi mathvariant="normal">.</mi><mi>l</mi><mo>+</mo><mi>a</mi><mo>[</mo><mi>v</mi><mo>]</mo><mi mathvariant="normal">.</mi><mi>l</mi><mo separator="true">,</mo><mi>p</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">s[p-a[u].l+a[v].l,p]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">]</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mclose">]</span></span></span></span> è¿™ä¸ªå­—ç¬¦ä¸²éƒ½å¿…ç„¶æ˜¯ä¸€æ ·çš„ï¼Œäºæ˜¯æˆ‘ä»¬åªè¦ä»»æ„åˆ¤å®šä¸€ä¸ªå°±è¡Œäº†ã€‚<br>
è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n^2\log_2{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mclose">)</span></span></span></span> çš„ dp ï¼šæšä¸¾ parent æ ‘ä¸Šçš„ç‚¹ u åŠå…¶ç¥–å…ˆèŠ‚ç‚¹ v å¹¶å°è¯•æ›´æ–°ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æœ‰å¿…è¦æšä¸¾æ¯ä¸ªç¥–å…ˆå—ï¼Ÿå¦‚æœ u ä¸èƒ½ç”±å…¶çˆ¶èŠ‚ç‚¹ v è½¬ç§»è¿‡æ¥ï¼Œé‚£ä¹ˆç”¨ v å»æ›´æ–° u çš„å­èŠ‚ç‚¹è‚¯å®šä¸ä¼šæ›´åŠ£ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ u ç»™å‹ç¼©åˆ° v ä¸­å»ã€‚<br>
å¤æ‚åº¦æˆåŠŸä¼˜åŒ–åˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n\log_2{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mclose">)</span></span></span></span> ã€‚</p>
<pre><code class="language-cpp">const int N=4e5+5;
using namespace std;
namespace SEG{
#define mid (l+r&gt;&gt;1)
#define Ls c[p][0],l,mid
#define Rs c[p][1],mid+1,r
    int tot;
    int t[N&lt;&lt;5],c[N&lt;&lt;5][2];
    void modify(int &amp;p,int l,int r,int pos){
        p=++tot;t[p]=1;
        if(l==r) return;
        if(pos&lt;=mid) modify(Ls,pos);
        else modify(Rs,pos);
    }
    void merge(int &amp;p,int x,int l,int r){
        if(!p||!x) return p=p|x,void();
        int now=++tot;
        c[now][0]=c[p][0],c[now][1]=c[p][1];t[now]=t[p]+t[x];p=now;
        if(l==r) return;
        merge(c[p][0],c[x][0],l,mid);
        merge(c[p][1],c[x][1],mid+1,r);
    }
    int query(int p,int l,int r,int nl,int nr){
        if(!p) return 0;
        if(l&gt;=nl&amp;&amp;r&lt;=nr) return t[p];
        int ret=0;
        if(mid&gt;=nl) ret+=query(Ls,nl,nr);
        if(mid&lt; nr) ret+=query(Rs,nl,nr);
        return ret;
    }
}
using namespace SEG;
namespace SAM{
    int tot,las;
    int f[N],g[N],ba[N],rk[N],rt[N],pos[N];
    struct node{
        int l,link,c[26];
    }a[N];
    void insert(int k,int id){
        int p=las,cur=las=++tot;
        a[cur].l=a[p].l+1;pos[cur]=id;
        while(p&amp;&amp;!a[p].c[k]) a[p].c[k]=cur,p=a[p].link;
        if(!p) return a[cur].link=1,void();
        int q=a[p].c[k];
        if(a[q].l==a[p].l+1) return a[cur].link=q,void();
        int now=++tot;a[now]=a[q];a[now].l=a[p].l+1;
        a[q].link=a[cur].link=now;pos[now]=pos[q];
        while(p&amp;&amp;a[p].c[k]==q) a[p].c[k]=now,p=a[p].link;
    }
    void basesort(){
        for(int i=1;i&lt;=tot;++i) ++ba[a[i].l];
        for(int i=1;i&lt;=tot;++i) ba[i]+=ba[i-1];
        for(int i=1;i&lt;=tot;++i) rk[ba[a[i].l]--]=i;
    }
    void build(char *s){
        tot=las=1;
        int len=strlen(s+1);
        for(int i=1;i&lt;=len;++i)
            insert(s[i]-='a',i);
        for(int i=1,u=1;i&lt;=len;++i)
            u=a[u].c[int(s[i])],modify(rt[u],1,len,i);
        basesort();
        for(int i=tot,u=rk[i];i&gt;=2;--i,u=rk[i])
            merge(rt[a[u].link],rt[u],1,len);
        int ans=1;f[1]=1;g[1]=1;
        for(int i=2,u=rk[i];i&lt;=tot;++i,u=rk[i]){
            int fa=a[u].link;
            if(fa==1){
                f[u]=1,g[u]=u;continue;
            }
            if(query(rt[g[fa]],1,len,pos[u]-a[u].l+a[g[fa]].l,pos[u]-1))
                f[u]=f[fa]+1,g[u]=u;
            else f[u]=f[fa],g[u]=g[fa];
            ans=max(ans,f[u]);
        }
        printf(&quot;%d\n&quot;,ans);
    }
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[[SHOI2014]ä¸‰å‰ç¥ç»æ ‘ è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/shoi2014san-cha-shen-jing-shu-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/shoi2014san-cha-shen-jing-shu-jie-ti-bao-gao/">
        </link>
        <updated>2021-01-06T10:22:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šä¸€æ£µä»¥ 1 ä¸ºæ ¹çš„æœ‰ 3*n+1 ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹å‡æœ‰ä¸€ä¸ªè¾“å‡ºç«¯ã€‚æ ‘ä¸Šæœ‰ n ä¸ªèŠ‚ç‚¹æœ‰ 3 ä¸ªå­èŠ‚ç‚¹ï¼Œå…¶ä½™çš„ 2*n+1 ä¸ªèŠ‚ç‚¹æ— å­èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯å¶å­ï¼‰ã€‚2*n+1 ä¸ªèŠ‚ç‚¹çš„åˆå§‹å€¼å‡ä¸º 0/1 ï¼Œå¹¶ä¸”å·²ç»æå‰çŸ¥é“ï¼›å‰©ä½™ n ä¸ªèŠ‚ç‚¹çš„å€¼ä¸ºå…¶ 3 ä¸ªå­èŠ‚ç‚¹ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å€¼ã€‚q æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡æ”¹å˜ä¸€ä¸ªå¶å­èŠ‚ç‚¹çš„å€¼ï¼Œæ±‚æ“ä½œåæ ¹èŠ‚ç‚¹çš„å€¼ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>q</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n,q\leq 5\times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>å¯ä»¥å‘ç°æ¯æ¬¡ä¿®æ”¹å¿…å®šæ˜¯ä¿®æ”¹ä¸€æ¡è‡ªåº•å‘ä¸Šçš„é“¾ã€‚å¹¶ä¸”è¿™æ¡é“¾æœ‰ä¸€äº›æ¯”è¾ƒæ˜æ˜¾çš„æ€§è´¨ï¼š</p>
<ul>
<li>é“¾ä¸Šçš„ç‚¹å¿…å®šä¿®æ”¹æˆåŒä¸€å€¼</li>
<li>u æ”¹å˜æ—¶ fa[u] ä¹Ÿæ”¹å˜ï¼Œå½“ä¸”ä»…å½“ fa[u] çš„å¦å¤–ä¸¤ä¸ªå­èŠ‚ç‚¹çš„å€¼æ°å¥½ä¸€ä¸ª 1 ä¸€ä¸ª 0</li>
</ul>
<p>ä½†æ˜¯å¦‚ä½•å¿«é€ŸæŸ¥è¯¢ä¿®æ”¹é“¾çš„é¡¶ç«¯èŠ‚ç‚¹ä»¥åŠä¿®æ”¹é“¾ä¸Šçš„ç‚¹å€¼å‘¢ï¼Ÿ<br>
ä¸å¦¨å†æ·±å…¥æ‰¾æ‰¾æ€§è´¨ã€‚<br>
å½“å¶å­èŠ‚ç‚¹ u ä» 0 å˜ä¸º 1 æ—¶ï¼Œè‹¥å…¶çˆ¶èŠ‚ç‚¹ v ç›®å‰çš„å­èŠ‚ç‚¹æƒå€¼å’Œä¸º 1 ï¼Œé‚£ä¹ˆçˆ¶èŠ‚ç‚¹å°†ä¼šç”± 0 å˜ä¸º 1 ï¼Œç»§ç»­ä¸Šä¼ ï¼›å¦åˆ™å°±æ­¤æ‰“ä½ã€‚åŒç†ï¼Œ v èƒ½å¤Ÿå†å½±å“åˆ° v çš„çˆ¶èŠ‚ç‚¹ k å½“ä¸”ä»…å½“ k çš„ç›®å‰çš„å­èŠ‚ç‚¹æƒå€¼å’Œä¸º 1 ã€‚å½“å¶å­èŠ‚ç‚¹ä» 1 å˜ä¸º 0 çš„æƒ…å†µä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡æ˜¯è¦æ±‚ç›®å‰çš„å­èŠ‚ç‚¹æƒå€¼å’Œä¸º 2 ã€‚<br>
é—®é¢˜è‡³æ­¤å°±æ°´è½çŸ³å‡ºäº†ã€‚æˆ‘ä»¬å°†é‚£ n ä¸ªèŠ‚ç‚¹æŒ‰ç…§å­èŠ‚ç‚¹çš„æƒå€¼å’Œåˆ†ä¸º 4 ç±»ï¼Œåˆ†åˆ«ä¸º 0-3 ã€‚<br>
é“¾ä¸Šçš„æŸ¥è¯¢åªä¼šåœ¨ç¢°åˆ°æ·±åº¦æœ€æ·±çš„é 1/2 ç±»èŠ‚ç‚¹æ—¶åœä¸‹æ¥ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨ LCT ä¸Šç»´æŠ¤ä¸‹è¿™ä¸ªä¸œè¥¿å°±è¡Œäº†ã€‚<br>
å‘ç°é“¾ä¸Šä¿®æ”¹å°±æ˜¯åŒºé—´ +1/-1 ï¼Œç›´æ¥æ‰“æ ‡è®°ä¹Ÿå¯ä»¥åšã€‚</p>
<p>å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>q</mi><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(q\log_2{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span></span><span class="mclose">)</span></span></span></span> ã€‚<br>
è¿™é“é¢˜å½“ç„¶ä¹Ÿå¯ä»¥ä¸ç”¨ LCT è€Œæ˜¯ç”¨æ ‘é“¾å‰–åˆ†ã€‚äº‹å®ä¸Šï¼Œè¿™åªæ˜¯ç”¨çº¿æ®µæ ‘ç»´æŠ¤é“¾è¿˜æ˜¯ç”¨ Splay ç»´æŠ¤é“¾çš„é—®é¢˜ã€‚è€Œç”±äºæ ‘é“¾å‰–åˆ†æ—¶é¦–å…ˆéœ€è¦æŠŠé“¾å‰–æˆ log æ®µï¼Œæ•…åœ¨æœ¬é¢˜ä¸­ï¼Œæ ‘é“¾å‰–åˆ†çš„å¤æ‚åº¦ä¸å¦‚ LCT ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">const int N=2e6+5;
using namespace std;
int n,q;
vector&lt;int&gt;child[N];
namespace LCT{
#define lc(x) c[x][0]
#define rc(x) c[x][1]
    int v[N],fa[N],one[N],two[N],tag[N],c[N][2];
    bool isrt(int x){
        return fa[x]==0 || (lc(fa[x])!=x&amp;&amp;rc(fa[x])!=x);
    }
    void update(int x){
        if(one[rc(x)]) one[x]=one[rc(x)];
        else if(v[x]^1) one[x]=x;
        else one[x]=one[lc(x)];
        if(two[rc(x)]) two[x]=two[rc(x)];
        else if(v[x]^2) two[x]=x;
        else two[x]=two[lc(x)];
    }
    void pushmk(int x,int d){
        tag[x]+=d;swap(one[x],two[x]);v[x]^=3;
    }
    void pushdn(int x){
        pushmk(lc(x),tag[x]);
        pushmk(rc(x),tag[x]);
        tag[x]=0;
    }
    void rotate(int x){
        int y=fa[x],z=fa[y],t=rc(y)==x;
        if(!isrt(y)) c[z][rc(z)==y]=x;fa[x]=z;
        c[y][t]=c[x][t^1];fa[c[x][t^1]]=y;
        c[x][t^1]=y;fa[y]=x;
        update(y),update(x);
    }
    void pushall(int x){
        if(!isrt(x)) pushall(fa[x]);
        if(tag[x]) pushdn(x);
    }
    void splay(int x){
        pushall(x);
        while(!isrt(x)){
            int y=fa[x],z=fa[y];
            if(!isrt(y))
                ((rc(y)==x)^(rc(z)==y))?rotate(x):rotate(y);
            rotate(x);
        }
        update(x);
    }
    void access(int x){
        int times=0;
        for(int i=0;x;x=fa[i=x])
            splay(x),rc(x)=i,update(x),++times;
    }
}
using namespace LCT;
void DFS(int p){
    for(auto u:child[p])
        DFS(u),v[p]+=(v[u]&gt;&gt;1);
    if(p&lt;=n) update(p);
}
int main(){
    
    r(n);
    for(int i=1;i&lt;=n;++i)
    for(int j=1,x;j&lt;=3;++j)
        r(x),child[i].push_back(x),fa[x]=i;
    for(int i=n+1;i&lt;=3*n+1;++i)
        r(v[i]),v[i]&lt;&lt;=1;
    DFS(1);
    r(q);int ans=v[1]&gt;&gt;1;
    for(int i=1,x;i&lt;=q;++i){
        r(x);
        int tp=(v[x]^=2)-1;
        access(x=fa[x]);splay(x);
        if((~tp?one:two)[x]){ // -1:1to0 1:0to1
            x=(~tp?one:two)[x];
            splay(x);pushmk(rc(x),tp);update(rc(x));
            v[x]+=tp;update(x);
        }
        else pushmk(x,tp),update(x),ans^=1;
        w(ans);
    }
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[[NOI2018]ä½ çš„åå­— è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/noi2018-ni-de-ming-zi/</id>
        <link href="https://parallelist-c.github.io/post/noi2018-ni-de-ming-zi/">
        </link>
        <updated>2021-01-05T09:36:49.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šå­—ç¬¦ä¸² s ã€‚æœ‰ q ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®å½¢å¦‚ t l r ï¼Œè¡¨ç¤ºæŸ¥è¯¢å­—ç¬¦ä¸² t ä¸­æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­ä¸²åœ¨ s[l:r] ä¸­<strong>æ²¡</strong>å‡ºç°è¿‡ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mo>â‰¤</mo><mn>5</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">q,|s|,|t|\leq 5\times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>å°†é—®é¢˜æ‹†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š<br>
ï¼ˆ1ï¼‰t ä¸­æœ¬è´¨ä¸åŒçš„å­ä¸²<br>
ï¼ˆ2ï¼‰åœ¨ s[l:r] ä¸­æ²¡å‡ºç°è¿‡çš„å­ä¸²</p>
<p>å»é‡çš„ç¬¬ä¸€æƒ³æ³•æ˜¯å¯¹äºä¸¤ä¸ªåœ¨ t ä¸²ä¸­å®Œå…¨ç›¸åŒçš„å­ä¸²ï¼Œä»…åœ¨ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®è®¡ç®—è´¡çŒ®ã€‚è¿™ä¸ªæƒ³æ³•å¾€å¾€ä¼šå› ä¸ºéš¾ä»¥æ‰¾åˆ°åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°è€Œè¢«æ‘’å¼ƒã€‚ä½†æ˜¯ï¼Œåœ¨æ­¤é¢˜ä¸­è¿™ä¸ªæƒ³æ³•æ˜¯å®ç”¨çš„ã€‚å»é‡çš„å·¥ä½œå¯ä»¥ç”± SAM å®ç°ï¼Œæ‰¾åˆ°ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¹Ÿå¯ä»¥é€šè¿‡åœ¨ parent æ ‘ä¸Šä¸Šä¼ æ ‡è®°å®ç°ã€‚<br>
å­ä¸²å¯ä»¥è§†ä½œåŸä¸²ä¸€æ®µå‰ç¼€çš„åç¼€ã€‚å¯¹äºä¸€ä¸ªä¸²ï¼Œæˆ‘ä»¬ä¸ä»…æ‰¾åˆ°å…¶ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®ï¼Œæ›´åŠ å…·ä½“åœ°ï¼Œæˆ‘ä»¬æŠŠå®ƒçš„è´¡çŒ®è®¡ç®—åœ¨ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„æœ«å°¾ä½ç½® i ä¸Šï¼Œä¹Ÿå°±æ˜¯ç®—ä½œ t[1:i] è¿™æ®µå‰ç¼€çš„è´¡çŒ®ã€‚<br>
æ­¤æ—¶æœ‰ä¸€ä¸ªé‡è¦ç»“è®ºï¼š</p>
<blockquote>
<p>è‹¥ j ä¸ºæœ€å¤§çš„æ»¡è¶³ t[j:i] çš„è´¡çŒ®è®¡å…¥ t[1:i] è¿™æ®µå‰ç¼€çš„è´¡çŒ®çš„ä½ç½®ï¼Œé‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ€</mi><mi>k</mi><mo>âˆˆ</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">\forall k\in [1,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord">âˆ€</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span> ï¼Œt[k:i] çš„è´¡çŒ®å‡è®¡å…¥ t[1:i] è¿™æ®µå‰ç¼€ä¸­ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯æ»¡è¶³ t[j:i] åœ¨ t[1:i] é€ æˆè´¡çŒ®çš„ j ä¸€å®šæ˜¯ä» 1 å¼€å§‹è¿ç»­çš„ä¸€æ®µã€‚æ¯•ç«Ÿå¦‚æœå­˜åœ¨ä¸€ä¸ªä½ç½® <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>p</mi><mo>âˆˆ</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">p(p\in[1,j))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> çš„è´¡çŒ®è®¡å…¥åˆ«å¤„ t[1:k] çš„è¯ï¼Œå°±è¯´æ˜ k ä¸€å®šå°äº i ã€‚é‚£ä¹ˆ t[p:i] çš„æ‰€æœ‰å­ä¸²éƒ½å¯ä»¥è®¡å…¥ t[1:k] ä¸Šã€‚äºæ˜¯å‡è®¾ä¸æˆç«‹ï¼Œç»“è®ºæ­£ç¡®ã€‚<br>
æœ‰äº†ä¸Šè¿°ç»“è®ºï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹äº t çš„æ¯ä¸ªä½ç½® i ï¼Œè®°å½•æœ€å¤§çš„ j æ»¡è¶³ t[i:j] çš„è´¡çŒ®è®¡å…¥ i çš„ j å°±è¡Œäº†ã€‚</p>
<p>æ¥ç€è€ƒè™‘å¦‚ä½•æ‰¾åœ¨ s[l:r] ä¸­æ²¡å‡ºç°è¿‡çš„å­ä¸²ã€‚å¯¹ s å»º SAM ï¼Œå¹¶åˆ©ç”¨åŠ¨æ€å¼€ç‚¹ç‰ˆçš„çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤ SAM ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„ endpos é›†åˆã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åˆ¤å®šæŸä¸ªé•¿åº¦ä¸º len çš„ä¸²æ˜¯å¦åœ¨ s[l:r] ä¸­å‡ºç°äº†â€”â€”æ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨è¯¥ç‚¹çš„çº¿æ®µæ ‘ä¸ŠæŸ¥è¯¢ [l+len-1,r] å†…æ˜¯å¦æœ‰ä¸€ä¸ª endpos ã€‚<br>
ç”¨ t ä¸²æ¥åŒ¹é… s ä¸²ã€‚å›ºå®šå³ç«¯ç‚¹ R ï¼Œæ‰¾åˆ°æœ€è¿œçš„ï¼Œæ»¡è¶³ t[L:R] åœ¨ s ä¸­å‡ºç°è¿‡çš„ L ã€‚äºæ˜¯å¯ä»¥å‘ç°å¯¹äºå›ºå®šçš„å³ç«¯ç‚¹ R è€Œè¨€ï¼Œä¸æ»¡è¶³ t[L:R] åœ¨ s ä¸­å‡ºç°è¿‡çš„ L æ°å¥½ä¹Ÿæ˜¯ä¸€æ®µå‰ç¼€ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°è¿™ä¸ª L ï¼Œé‚£ä¹ˆå°±åªéœ€è¦ä¸ä¸Šé¢è®¡å…¥è´¡çŒ®çš„é‚£ä¸ª j å– min å°±è¡Œäº†ã€‚<br>
æ€ä¹ˆåœ¨ SAM ä¸ŠåŒ¹é…å­—ç¬¦ä¸²å‘¢ï¼Ÿè€ƒè™‘è·³ link è¾¹æœ¬è´¨ä¸Šæ˜¯ä¸¢å¼ƒä¸€æ®µå·²åŒ¹é…çš„å‰ç¼€ã€‚å½“ç°æœ‰çš„å‰ç¼€æ— æ³•æ»¡è¶³åŠ å…¥ç¬¬ R+1 ä¸ªå­—æ¯çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¸å¦¨ä¸¢å¼ƒä¸€æ®µå‰ç¼€ï¼Œå‰©ä¸‹çš„åç¼€æ›´åŠ çµæ´»ï¼Œæ›´æœ‰å¯èƒ½å…è®¸åŠ å…¥ç¬¬ R+1 ä¸ªå­—ç¬¦ã€‚æ•…æˆ‘ä»¬èƒ½æ¥å°±æ¥ï¼Œä¸èƒ½æ¥å°±è·³ link ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ¬é¢˜ä¸­çš„åŒ¹é…åªå…è®¸åœ¨ s[l:r] ä¸­æ‰¾ï¼Œå½“è¿™ä¸ªåŒºé—´ä¸­æ²¡æœ‰è½¬ç§»åçš„å­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»å†è·³ link ã€‚</p>
<p>æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼šå°½ç®¡æˆ‘åœ¨å™è¿°æ—¶ç”¨çš„æ˜¯è·³ link ï¼Œä½†å®é™…å¹¶éå¦‚æ­¤ã€‚ SAM ä¸Šçš„ä¸€ä¸ªèŠ‚ç‚¹ç»´æŠ¤äº†è‹¥å¹²ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿè®¸å½“ä¸¢å¼ƒäº†ä¸€æ®µå‰ç¼€åçš„å­—ç¬¦ä¸²ä»ç„¶åœ¨è¯¥èŠ‚ç‚¹ä¸­ï¼Œæ­¤æ—¶æ— éœ€è·³ link è¾¹ã€‚åŠ¡å¿…è¦å°å¿ƒã€‚</p>
<p>å¯¹äºä¸€ä¸ª R ï¼Œå‰åä¸¤æ¬¡æ±‚å‡ºæ¥çš„ L å– min å³ä¸ºè¯¥ä½ç½®ä¸Šçš„ç­”æ¡ˆã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><msub><mi>log</mi><mo>â¡</mo><mn>2</mn></msub><mrow><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(|s|\log_2{|s|})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span></span><span class="mclose">)</span></span></span></span> ã€‚</p>
<h2 id="code">Code</h2>
<p>å®ç°çš„æœ‰ç‚¹ä¸‘é™‹... ç¬¬ä¸€æ¬¡å†™ç å†œå­—ç¬¦ä¸²é¢˜ğŸ¤¢...</p>
<pre><code class="language-cpp">const int N=1e6+5;
using namespace std;
namespace SEG{
#define mid (l+r&gt;&gt;1)
#define ls c[p][0],l,mid
#define rs c[p][1],mid+1,r
    int tot;
    int t[N&lt;&lt;5],c[N&lt;&lt;5][2];
    void modify(int &amp;p,int l,int r,int pos){
        p=++tot;t[p]=1;
        if(l==r) return void();
        if(pos&lt;=mid) modify(ls,pos);
        else modify(rs,pos);
    }
    void merge(int &amp;p,int x,int l,int r){
        if(p==0||x==0) return p=x+p,void();
        int cur=++tot;
        t[cur]=t[p]+t[x],c[cur][0]=c[p][0],c[cur][1]=c[p][1];
        p=cur;
        if(l==r) return;
        merge(c[p][0],c[x][0],l,mid);
        merge(c[p][1],c[x][1],mid+1,r);
    }
    int query(int p,int l,int r,int nl,int nr){
        if(l&gt;=nl&amp;&amp;r&lt;=nr) return t[p];
        int ret=0;
        if(mid&gt;=nl) ret+=query(ls,nl,nr);
        if(mid&lt; nr) ret+=query(rs,nl,nr);
        return ret; 
    }
    void print(int p,int l,int r){
        if(l==r) printf(&quot;%d &quot;,l);
        if(t[c[p][0]]) print(ls);
        if(t[c[p][1]]) print(rs);
    }
}
namespace SAM1{
    int t[N],A[N],rk[N],rt[N];
    int las,tot,len;
    struct SAM{
        int l,link,c[26];
    }a[N];
    void insert(int k,int i){
        int p=las,cur=las=++tot;SEG::modify(rt[cur],1,len,i);
        a[cur].l=a[p].l+1;
        while(p&amp;&amp;!a[p].c[k]) a[p].c[k]=cur,p=a[p].link;
        if(p==0) return a[cur].link=1,void();
        int q=a[p].c[k];
        if(a[q].l==a[p].l+1) return a[cur].link=q,void();
        int now=++tot;
        a[now]=a[q];a[now].l=a[p].l+1,a[cur].link=a[q].link=now;
        while(p&amp;&amp;a[p].c[k]==q) a[p].c[k]=now,p=a[p].link;
    }
    void basesort(){
        for(int i=1;i&lt;=tot;++i) ++t[a[i].l];
        for(int i=1;i&lt;=len;++i) t[i]+=t[i-1];
        for(int i=1;i&lt;=tot;++i) rk[t[a[i].l]--]=i;
    }
    void solve(char *s){
        las=tot=1;
        len=strlen(s+1);
        for(int i=1;i&lt;=len;++i)
            insert(s[i]-'a',i);
        basesort();
        for(int i=tot;i&gt;=2;--i){
            int u=rk[i];
            SEG::merge(rt[a[u].link],rt[u],1,len);
        }
    }
    void match(char *s,int l,int r){
        int leng=strlen(s+1),L=1,R=0;
        for(int i=1,u=1;i&lt;=leng;++i){
            while((L&lt;=R)&amp;&amp;!SEG::query(rt[a[u].c[s[i]-'a']],1,len,l+(R-L+1),r)){
                ++L;
                if(a[u].link&amp;&amp;a[a[u].link].l&gt;=R-L+1)
                    u=a[u].link;
            }
            if(SEG::query(rt[a[u].c[s[i]-'a']],1,len,l+(R-L+1),r)) 
                u=a[u].c[s[i]-'a'];
            else ++L;
            A[++R]=L-1;
        }
    }
}
namespace SAM2{
    int t[N],B[N],rk[N],pos[N];
    int las,tot,len;
    struct SAM{
        int l,link,c[26];
    }a[N];
    void reset (int p){
        memset(a[p].c,0,sizeof a[p].c);
        a[p].link=a[p].l=0;
    }
    void insert(int k){
        int p=las,cur=las=++tot;reset(tot);
        a[cur].l=a[p].l+1;
        while(p&amp;&amp;!a[p].c[k]) a[p].c[k]=cur,p=a[p].link;
        if(p==0) return a[cur].link=1,void();
        int q=a[p].c[k];
        if(a[q].l==a[p].l+1) return a[cur].link=q,void();
        int now=++tot;reset(tot);
        a[now]=a[q];a[now].l=a[p].l+1,a[cur].link=a[q].link=now;
        while(p&amp;&amp;a[p].c[k]==q) a[p].c[k]=now,p=a[p].link;
    }
    void basesort(){
        for(int i=1;i&lt;=tot;++i) ++t[a[i].l];
        for(int i=1;i&lt;=len;++i) t[i]+=t[i-1];
        for(int i=1;i&lt;=tot;++i) rk[t[a[i].l]--]=i;
        for(int i=1;i&lt;=tot;++i) t[a[i].l]=0; 
    }
    void solve(char *s){
        las=tot=1;reset(1);
        len=strlen(s+1);
        for(int i=1;i&lt;=len;++i)
            insert(s[i]-='a');
        for(int i=1;i&lt;=tot;++i) pos[i]=0x3f3f3f3f;
        for(int i=1,u=1;i&lt;=len;++i){
            u=a[u].c[int(s[i])];
            pos[u]=i;
            B[i]=0x3f3f3f3f;
        }
        basesort();
        for(int i=tot,u=rk[i];i&gt;=1;--i,u=rk[i])
            pos[a[u].link]=min(pos[a[u].link],pos[u]);
        for(int i=1,u=rk[i];i&lt;=tot;++i,u=rk[i])
            B[pos[u]]=min(B[pos[u]],a[a[u].link].l);
        for(int i=1;i&lt;=len;++i)
            B[i]=i-B[i];
    }
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[CF526D Om Nom and Necklace è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/cf526d-om-nom-and-necklace-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/cf526d-om-nom-and-necklace-jie-ti-bao-gao/">
        </link>
        <updated>2021-01-04T10:45:32.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸² s ï¼Œå¯¹äº s çš„æ¯ä¸ªå‰ç¼€ï¼Œæ±‚è¯¥å‰ç¼€æ˜¯å¦èƒ½æ»¡è¶³ AB...ABA çš„å½¢å¼ï¼Œå…¶ä¸­ A æ°å¥½æœ‰ k+1 ä¸ªï¼ŒB æ°å¥½æœ‰ k ä¸ª ã€‚A B å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œæˆ–è€…ä¸ºç©ºä¸²ï¼›k æ˜¯ç»™å®šçš„ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo separator="true">,</mo><mi>k</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">1\leq n,k\leq 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>éå¸¸ç›´è§‚çš„æƒ³æ³•å°±æ˜¯å°† AB è§†ä½œä¸€ä¸ªæ•´ä½“ï¼Œå†åœ¨æœ€ååŠ ä¸ª A ã€‚<br>
ç”±äº k æ˜¯ç»™å®šçš„ï¼Œå½“å¾ªç¯èŠ‚é•¿åº¦ä¹Ÿç»™å®šæ—¶ï¼Œå‰ç¼€æ˜¯ç¡®å®šçš„ã€‚æ•…æˆ‘ä»¬å¯ä»¥æšä¸¾å¾ªç¯èŠ‚é•¿åº¦ c ï¼Œç„¶ååˆ¤å®š s[1:ck] æ˜¯å¦ä¸ºå¾ªç¯èŠ‚æ¬¡æ•°ä¸º k çš„ä¸¥æ ¼å¾ªç¯å­ä¸²ã€‚å¦‚ä½•å¿«é€Ÿåˆ¤å®šå‘¢ï¼Ÿè€ƒè™‘å½“ s[1:ck] ç¬¦åˆè¦æ±‚æ—¶ï¼Œ s[1:c(k-1)]=s[k+1:ck] ï¼Œå¹¶ä¸”äº’ä¸ºå……åˆ†å¿…è¦æ¡ä»¶ã€‚æ­£ç€éå¸¸ç›´è§‚ï¼Œåè¿‡æ¥è¯æ˜å¯ä»¥è¿™æ ·è€ƒè™‘ï¼šs[1:k]=s[k+1:2k]=s[2k+1:3k]=... ã€‚ç±»ä¼¼äºé”™ä½ç›¸æ¶ˆï¼Ÿ ğŸ¤”</p>
<p>ç”±ä¸Šå¯çŸ¥ä¸€ä¸ªé‡è¦çš„ trick ï¼š</p>
<blockquote>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mtext>Z</mtext><mi>k</mi></msub><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\text{Z}_{k}\ge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span></span></span></span> c(k-1) ä¸ s[1:ck] ä¸ºå¾ªç¯èŠ‚æ¬¡æ•°ä¸º k çš„ä¸¥æ ¼å¾ªç¯å­ä¸²äº’ä¸ºå……è¦æ¡ä»¶ã€‚</p>
</blockquote>
<p>æ’å¥é—²è¯ï¼Œå¦‚æœè¦åˆ¤æ–­ s[l,r] æ˜¯å¦ä¸ºå¾ªç¯èŠ‚é•¿åº¦ä¸º k çš„ä¸¥æ ¼å¾ªç¯å­ä¸²æ—¶å¯ä»¥å“ˆå¸Œåˆ¤æ–­ s[l:r-k] å’Œ s[l+k:r] æ˜¯å¦ç›¸ç­‰ã€‚è¯æ˜æ–¹æ³•ä¸ä¸Šè¿°é”™ä½ç›¸æ¶ˆç±»ä¼¼ã€‚</p>
<p>å›åˆ°è¿™ä¸ªé¢˜ï¼Œæˆ‘ä»¬å·²ç»æ±‚å‡ºæ¥äº†æ‰€æœ‰å¾ªç¯èŠ‚é•¿åº¦æ°å¥½ä¸º c çš„ä½ç½®ï¼Œç°åœ¨å†è€ƒè™‘å¦‚ä½•åœ¨ s[ck] åæ’å…¥ A ã€‚æ˜¾ç„¶ï¼Œ A çš„é•¿åº¦å°äºç­‰äº c ï¼Œå¹¶ä¸”åœ¨ c ä¸­å‡ºç°è¿‡ã€‚è¿™ä¸æ°å¥½å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext>min</mtext><mo>(</mo><msub><mtext>Z</mtext><mrow><mi>c</mi><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>c</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\text{min}(\text{Z}_{ck+1},c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">min</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span> å˜›ã€‚å¹¶ä¸”å¯ä»¥å‘ç°æ˜¯ä¸€æ•´æ®µä¸€æ•´æ®µçš„ç¬¦åˆæ¡ä»¶ï¼Œæ‰€ä»¥ç›´æ¥å·®åˆ†ç»´æŠ¤å°±è¡Œäº†ã€‚<br>
ç®—æ³•å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå¯¹äº ABA...A çš„ä¸²ï¼Œä¸€ç§æ›´åŠ ç›´è§‚çš„æƒ³æ³•æ˜¯ç›´æ¥ kmp æ±‚ border ã€‚kmp æ±‚å‡ºæ¥çš„éä¸¥æ ¼å¾ªç¯èŠ‚å½¢å¼ä¸Šä¹Ÿæ›´åƒã€‚ä½†æ˜¯ç”±äºæ­¤é¢˜é™åˆ¶äº†å¾ªç¯æ¬¡æ•°ä¸º k ï¼Œä¼¼ä¹é™¤äº†æš´åŠ›è·³ fail ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½çš„æšä¸¾åŠæ³•ã€‚<br>
å…¶å®ä¸ç„¶ã€‚æˆ‘ä»¬è®¾å½“å‰æšä¸¾åˆ°ç¬¬ i ä½ã€‚å½“å‰çš„æœ€é•¿ border ä¸º fail[i] ï¼Œå‘¨æœŸä¸º T=i-fail[i] ï¼Œå¾ªç¯æ¬¡æ•°ä¸º d=i/(i-fail[i]) ä¸‹å–æ•´ã€‚é‰´äºæˆ‘ä»¬éœ€è¦çš„å¾ªç¯æ¬¡æ•°ä¸º k ï¼Œæˆ‘ä»¬ç›´æ¥é’¦å®šæ¯ d/k ï¼ˆä¸‹å–æ•´ï¼‰ ä¸ªå°å¾ªç¯ä¸ºä¸€ä¸ªå¤§å¾ªç¯ï¼Œ å‰©ä¸‹çš„ d mod k ä¸ªå°å¾ªç¯ä¸º A ã€‚<br>
å½“ i æ°å¥½ä¸ºè‹¥å¹²æ¬¡å°å¾ªç¯æ—¶ï¼ŒB å¯ä»¥ä¸ºç©ºä¸²ï¼›å¦åˆ™çš„è¯ï¼ŒB ä¸èƒ½ä¸ºç©ºä¸²ã€‚<br>
ç®—æ³•å¤æ‚åº¦ä¹Ÿæ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ã€‚</p>
<p>ä»£ç é‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹æ³•ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">for(int i=1;i&lt;=len;++i){
        int d=i/(i-fail[i]);
        if(i%(i-fail[i])) putchar((d/k-d%k&gt;0)+'0');
        else putchar((d/k-d%k&gt;=0)+'0');
    }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Luogu4173 æ®‹ç¼ºçš„å­—ç¬¦ä¸² è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/luogu4173-can-que-de-zi-fu-chuan-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/luogu4173-can-que-de-zi-fu-chuan-jie-ti-bao-gao/">
        </link>
        <updated>2021-01-03T10:47:15.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸² A å’Œé•¿åº¦ä¸º m çš„å­—ç¬¦ä¸² B ã€‚å½“ä»¥ A ä¸ºæ¨¡å¼ä¸²æ—¶ï¼Œä½ å¸Œæœ›æ±‚å‡ºå¯¹äº B çš„æ¯ä¸€ä¸ªä½ç½® i ï¼Œä»è¯¥ä½ç½®å¼€å§‹çš„è¿ç»­ n ä¸ªå­—ç¬¦å½¢æˆçš„å­ä¸²æ˜¯å¦èƒ½ä¸ A å®Œå…¨åŒ¹é…ã€‚A B ä¸­å¯èƒ½å«æœ‰é€šé…ç¬¦ @ ã€‚é€šé…ç¬¦å¯ä»¥è§†ä½œä¸ºä»»æ„å°å†™å­—æ¯ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>â‰¤</mo><mi>n</mi><mo>â‰¤</mo><mi>m</mi><mo>â‰¤</mo><mn>3</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">1\leq n\leq m\leq 3\times 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p><s>ã€Šå­—ç¬¦ä¸²å“²å­¦ä¸­çš„å¤šé¡¹å¼æ–¹æ³•ã€‹</s><br>
å¤šé¡¹å¼æ–¹æ³•åœ¨å­—ç¬¦ä¸²åŒ¹é…é—®é¢˜ä¸­çš„åº”ç”¨ä¹Ÿå¾ˆå¹¿æ³›ã€‚<br>
æ¯”è¾ƒå¸¸è§çš„ä¸€ç§ç±»å‹æ˜¯å°†å­—ç¬¦æ˜ å°„æˆç‰¹å®šçš„å€¼ï¼Œä½¿å¾—å·ç§¯åæ•°ç»„ä½ç½®ä¸Šçš„å€¼æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚è¿™ç§æ–¹æ³•å¾ˆçµæ´»ã€‚<br>
åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬å…ˆéšæœºç»™å­—ç¬¦ï¼ˆé™¤é€šé…ç¬¦å¤–ï¼‰æ˜ å°„æˆä¸€ä¸ªå€¼ï¼Œå°† A ä¸­çš„å­—æ¯æ˜ å°„æˆè¯¥å€¼ï¼ŒB ä¸­çš„å­—æ¯æ˜ å°„æˆè¯¥å€¼çš„é€†å…ƒã€‚é‚£ä¹ˆï¼Œå½“æ²¡æœ‰é€šé…ç¬¦æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ±‚è§£è¿™æ ·ä¸€ä¸ªæ•°ç»„ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><mrow><msub><mi>A</mi><mi>j</mi></msub><mo>Ã—</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">f_i=\sum_{j=0}^{m}{A_j\times B_{i+j}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å½“ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">f_i=m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> æ—¶ï¼Œæ„å‘³ç€ i ä½ç½®æ˜¯å¯è¡Œçš„ã€‚<br>
è§‚å¯Ÿåˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> çš„æ±‚è§£æ˜¯å‡æ³•é€†å…ƒçš„å½¢å¼ã€‚æˆ‘ä»¬ä»¤ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_i=A_{m-1-i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œåˆ™ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><mrow><msub><mi>A</mi><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>j</mi></mrow></msub><mo>Ã—</mo><msub><mi>B</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>+</mo><mi>k</mi><mo>=</mo><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>+</mo><mi>i</mi></mrow></munder><msub><mi>A</mi><mi>j</mi></msub><mo>Ã—</mo><msub><mi>B</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">f_i=\sum_{j=0}^{m}{A_{m-1-j}\times B_{i+j}}=\sum_{j+k=m-1+i}A_j\times B_k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>NTT å¯ä»¥åšã€‚<br>
é€šé…ç¬¦ä¸€å®šå¯ä»¥åŒ¹é…ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸éœ€è¦é€šé…ç¬¦ä¸å…¶å¯¹åº”ä½å‚ä¸è¯¥è¿ç®—ä¸­ï¼Œè€Œå¯ä»¥åœ¨äº‹åç»Ÿè®¡ã€‚äºæ˜¯æˆ‘ä»¬å°†é€šé…ç¬¦æ˜ å°„ä¸º 0 ï¼Œå¹¶åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¤„åŠ ä¸Š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[1,i+m-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> ä¸­é€šé…ç¬¦çš„æ•°é‡ ã€‚<br>
ä½†æ˜¯æœ‰å¯èƒ½æ°å¥½ä¸¤ä¸ªé€šé…ç¬¦åŒ¹é…ä¸Šäº†ï¼Œæ­¤æ—¶ç†åº”åªç®—ä¸€æ¬¡è´¡çŒ®ã€‚è¿™éƒ¨åˆ†çš„å®¹æ–¥æ˜¾ç„¶å¯ä»¥é€šè¿‡ä»…å°†é€šé…ç¬¦è®¾ä¸º 1 åå·ç§¯å¾—åˆ°ï¼Œæ–¹æ³•ä¸ä¸Šè¿°æ±‚è§£ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯æ„é€ æ–°è¿ç®—ã€‚å®šä¹‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">m(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> è¡¨ç¤º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi>B</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">A_x,B_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> æ˜¯å¦åŒ¹é…ï¼Œè‹¥åŒ¹é…åˆ™ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m(x,y)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> ï¼›å¦åˆ™ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mi mathvariant="normal">â‰ </mi><mn>0</mn></mrow><annotation encoding="application/x-tex">m(x,y)\ne 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> ã€‚<br>
è€ƒè™‘åˆ°æˆ‘ä»¬æ˜¯è¿™æ ·åˆ¤å®šä¸¤ä¸ªå­ä¸²æ˜¯å¦ç›¸ç­‰çš„ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mi>m</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>)</mo><mo>=</mo><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[\sum_{i=0}^{n}m(i,i)=0]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mopen">[</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span></p>
<p>æ•…æˆ‘ä»¬éœ€è¦è¯¥è¿ç®—çš„ç»“æœæ»¡è¶³éè´Ÿæ€§/éæ­£æ€§ï¼ˆé˜²æ­¢æŠµæ¶ˆï¼‰ï¼Œå¹¶ä¸”å¯ä»¥å…¼å®¹é€šé…ç¬¦ã€‚<br>
å…¶å®ä»éè´Ÿæ€§/éæ­£æ€§å°±å¯ä»¥å¤§è‡´å¾—å‡ºæ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹æ„é€  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">m()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span> è¿ç®—ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo><mo>=</mo><msub><mi>A</mi><mi>x</mi></msub><msub><mi>B</mi><mi>y</mi></msub><mo>(</mo><msub><mi>A</mi><mi>x</mi></msub><mo>âˆ’</mo><msub><mi>B</mi><mi>y</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">m(x,y)=A_xB_y(A_x-B_y)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¹¶å°†é€šé…ç¬¦å®šä¹‰ä¸º 0 ã€‚<br>
äºæ˜¯æˆ‘ä»¬éœ€è¦æ±‚çš„</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mi>m</mi><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>+</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g_i=\sum_{j=0}^{n}m(i,i+j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></p>
<p>ä¹Ÿå¯ä»¥é€šè¿‡æš´åŠ›å±•å¼€æ‹¬å·åå‡æ³•å·ç§¯æ±‚å¾—ã€‚æœ€åçš„ç»“æœä¸ºï¼ˆè®¾ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn><mo>âˆ’</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_i=A_{m-1-i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼š</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>+</mo><mi>k</mi><mo>=</mo><mi>i</mi></mrow></munder><msubsup><mi>C</mi><mi>j</mi><mn>3</mn></msubsup><msub><mi>A</mi><mi>k</mi></msub><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>+</mo><mi>k</mi><mo>=</mo><mi>i</mi></mrow></munder><msubsup><mi>C</mi><mi>j</mi><mn>2</mn></msubsup><msubsup><mi>A</mi><mi>k</mi><mn>2</mn></msubsup><mo>+</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>+</mo><mi>k</mi><mo>=</mo><mi>i</mi></mrow></munder><msub><mi>C</mi><mi>j</mi></msub><msubsup><mi>A</mi><mi>k</mi><mn>3</mn></msubsup></mrow><annotation encoding="application/x-tex">g_i=\sum_{j+k=i}C_j^3A_k+\sum_{j+k=i}C_j^2A_k^2+\sum_{j+k=i}C_jA_k^3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.438221em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>ä»£ç é‡‡ç”¨çš„æ˜¯ç¬¬ä¸€ç§æ–¹æ³•ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">int main(){

    scanf(&quot;%d%d&quot;,&amp;m,&amp;n);
    scanf(&quot;%s&quot;,t);scanf(&quot;%s&quot;,s);

    srand(19260817);
    for(int i=0;i&lt;26;++i)
        d[i]=max(rand()%Mod,2),invd[i]=Q(d[i],Mod-2); // æ³¨æ„éšæœºåŒ–çš„å€¼ä¸èƒ½ä¸º 0
    
    for(int i=0;i&lt;m;++i) f[i]=t[i]=='*';
    for(int i=0;i&lt;n;++i) g[i]=s[i]=='*';
    reverse(f,f+m);
    Getmul(f,g,h,m,n);

    int sum=0;
    szs[0]=s[0]=='*';
    for(int i=1;i&lt;n;++i) 
        szs[i]=szs[i-1]+(s[i]=='*');
    for(int i=0;i&lt;m;++i) sum+=t[i]=='*';
    for(int i=0;i&lt;m;++i) f[i]=t[i]=='*'?0:d[t[i]-'a'];
    for(int i=0;i&lt;n;++i) g[i]=s[i]=='*'?0:invd[s[i]-'a'];
    reverse(f,f+m);
    Getmul(f,g,l,m,n);

    for(int i=0;i&lt;=n-m;++i)
        if(l[i+m-1]-h[i+m-1]+sum+szs[i+m-1]-(i==0?0:szs[i-1])==m) 
            ans.push_back(i+1);
    printf(&quot;%d\n&quot;,ans.size());
    for(auto x:ans)
        printf(&quot;%d &quot;,x);
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[[HNOI2004]Lè¯­è¨€ è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/hnoi2004l-yu-yan/</id>
        <link href="https://parallelist-c.github.io/post/hnoi2004l-yu-yan/">
        </link>
        <updated>2021-01-03T04:45:53.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šä¸€ä¸ªç”± n ä¸ªå­—ç¬¦ä¸² s ç»„æˆçš„å­—å…¸ï¼Œå†ç»™å®š m å¥è¯ t ï¼Œæ±‚æ¯å¥è¯åœ¨è¯¥å­—å…¸ä¸‹å¯ä»¥ç†è§£çš„æœ€é•¿å‰ç¼€ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>20</mn><mo separator="true">,</mo><mi>m</mi><mo>â‰¤</mo><mn>50</mn><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><mo>â‰¤</mo><mn>10</mn><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mo>â‰¤</mo><mn>2</mn><mo>Ã—</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n\leq 20,m\leq 50,|s|\leq 10,|t|\leq 2\times 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>è€ƒè™‘æœ´ç´ åšæ³•ã€‚è®¾ f[i] è¡¨ç¤º t[1:i] èƒ½å¦è¢«ç†è§£ã€‚</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>=</mo><munder><mo>â‹ƒ</mo><mrow><mi>j</mi><mo>&lt;</mo><mi>i</mi></mrow></munder><mo>(</mo><mi>f</mi><mo>[</mo><mi>j</mi><mo>]</mo><mtext>Â andÂ </mtext><mo>[</mo><mi>t</mi><mo>[</mo><mi>i</mi><mo>:</mo><mi>j</mi><mo>]</mo><mtext>in</mtext><mo>{</mo><mi>s</mi><mo>}</mo><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">f[i]= \bigcup\limits_{j&lt;i} (f[j] \text{ and } [t[i:j] \text{in} \{s\}]) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.463782em;vertical-align:-1.413777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8723309999999997em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">&lt;</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">â‹ƒ</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.413777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mord text"><span class="mord">Â andÂ </span></span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mord text"><span class="mord">in</span></span><span class="mopen">{</span><span class="mord mathdefault">s</span><span class="mclose">}</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></span></p>
<p>å¦‚æœé‡‡ç”¨å“ˆå¸Œåˆ¤æ–­ï¼Œå¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>m</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(m|s||t|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mclose">)</span></span></span></span> ï¼Œæœ‰ç‚¹å¡å¸¸ã€‚</p>
<p>é¢˜ç›®ä¸­ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mi mathvariant="normal">âˆ£</mi><mo>â‰¤</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">|s|\leq 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathdefault">s</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span></span></span></span> çš„èŒƒå›´å¾ˆæœ‰ç‰¹ç‚¹ï¼Œè¿™æ„å‘³ç€æ¯æ¬¡å‘å‰è‡³å¤šåªä¼šæ¯”è¾ƒ 10 æ¬¡ã€‚<br>
æŠ›å¼€å“ˆå¸Œï¼Œæˆ‘ä»¬é‡æ–°è€ƒè™‘åŒ¹é…çš„è¿‡ç¨‹ã€‚å¯¹ s ä¸²å»º AC è‡ªåŠ¨æœºï¼Œå½“åŒ¹é… t[i] æ—¶ï¼Œå‡è®¾åœ¨ AC è‡ªåŠ¨æœºä¸Šèµ°åˆ°äº† u èŠ‚ç‚¹ã€‚è‹¥ u æœ‰ end æ ‡è®°ï¼Œæˆ‘ä»¬å°±å†å›åˆ° t ä¸²æŸ¥è¯¢å¯¹åº”çš„ f[j] æ˜¯å¦ä¸º true ï¼›å¦åˆ™ï¼Œæˆ‘ä»¬å°±éå† fail[u] ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªä¸¤è€…å‡ä¸º true çš„ä½ç½®æˆ–è€…æ‰¾åˆ°æ ¹èŠ‚ç‚¹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦ f<a href="j%3Ci">j</a> ä»¥åŠ u åœ¨ fail æ ‘ä¸Šçš„æ‰€æœ‰ç¥–å…ˆçš„ end æ ‡è®°ä¿¡æ¯ã€‚ç”±äº fail æ ‘æ ‘é«˜ä¸è¶…è¿‡ 10 ï¼Œæ‰€ä»¥ä¸¤è€…æˆ‘ä»¬éƒ½å¯ä»¥çŠ¶å‹ã€‚å³ä»¤ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>a</mi><mi>s</mi><mo>=</mo><msup><mn>2</mn><mi>i</mi></msup><mo>Ã—</mo><mo>[</mo><msub><mi>f</mi><mrow><mi>j</mi><mo>âˆ’</mo><mi>i</mi></mrow></msub><mo>]</mo></mrow><annotation encoding="application/x-tex">las=2^i\times[f_{j-i}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.907994em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>u</mi></msub><mo>=</mo><msub><mi>g</mi><msub><mtext>fa</mtext><mi>u</mi></msub></msub><mo>+</mo><mo>(</mo><msup><mn>2</mn><msub><mtext>len</mtext><mi>u</mi></msub></msup><mo>Ã—</mo><mo>[</mo><mtext>end</mtext><mo>[</mo><mi>u</mi><mo>]</mo><mo>]</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">g_u=g_{\text{fa}_u}+(2^{\text{len}_u}\times [\text{end}[u]])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83343em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">fa</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">len</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord text"><span class="mord">end</span></span><span class="mopen">[</span><span class="mord mathdefault">u</span><span class="mclose">]</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span> ã€‚</p>
<p>äºæ˜¯å°±å¯ä»¥åšåˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> åˆ¤æ–­äº†ã€‚å¤æ‚åº¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">O</mi><mo>(</mo><mi>m</mi><mi mathvariant="normal">âˆ£</mi><mi>t</mi><mi mathvariant="normal">âˆ£</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(m|t|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.02778em;">O</span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord">âˆ£</span><span class="mord mathdefault">t</span><span class="mord">âˆ£</span><span class="mclose">)</span></span></span></span> ã€‚</p>
<p><s>æœ¬è´¨å°±æ˜¯é€šè¿‡çŠ¶å‹å¡å¸¸æ•°è€Œå·² ğŸ˜¶ã€‚10 åªæ˜¯æ–¹ä¾¿äº†ä¸€ä¸ª int å¯ä»¥å‹ä¸‹æ¥ï¼Œä»»æ„é•¿åº¦éƒ½å¯ä»¥çŠ¶å‹ã€‚</s></p>
<p>ä½†æ˜¯å¦‚æœå“ˆå¸Œå°±æ— æ³•å¡å¸¸äº†... æ‰€ä»¥è¯´å°†åŒ¹é…è¿‡ç¨‹çœ‹ä½œåœ¨ fail æ ‘ä¸Šè·³ï¼Œç”±äºæ ‘æ˜¯å¯ä»¥é¢„å¤„ç†å‡ºæ¥çš„ï¼Œå¹¶ä¸”æ ‘ä¸Šç®—æ³•è¿˜æ˜¯æŒºæˆç†Ÿçš„ï¼Œæ²¡å‡†å¯ä»¥æœ‰å¥‡æ•ˆã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">const int N=1e3+5,L=2e6+5;
using namespace std;
int n,m;
namespace ACM{
    int tot;
    int g[N],dep[N],fail[N],endpos[N],t[N][26];
    void insert(char *s){
        int len=strlen(s),u=0;
        for(int i=0;i&lt;len;++i){
            int v=s[i]-'a';
            if(!t[u][v]) t[u][v]=++tot,dep[tot]=dep[u]+1;
            u=t[u][v]; 
        }
        endpos[u]=1;
    }
    void prework(){
        queue&lt;int&gt;q;int u=0;
        for(int i=0;i&lt;26;++i)
            if(t[u][i]) q.push(t[u][i]),g[t[u][i]]=endpos[t[u][i]];
        while(!q.empty()){
            u=q.front();q.pop();
            for(int i=0;i&lt;26;++i)
                if(!t[u][i]) t[u][i]=t[fail[u]][i];
                else{
                    int v=t[u][i];fail[v]=t[fail[u]][i];
                    g[v]=g[fail[v]]|(endpos[v]&lt;&lt;dep[v]-1);q.push(v);
                }
        }
    }
    int solve(char *s){
        int len=strlen(s),u=0,lst=1,ans=0;
        for(int i=0;i&lt;len;++i){
            u=t[u][s[i]-'a'];
            bool now=(g[u]&amp;lst);
            lst&lt;&lt;=1,lst|=now,lst&amp;=1023;
            if(now) ans=i+1;
        }
        return ans;
    }
}
char s[N],t[L];
int main(){

    scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
    for(int i=1;i&lt;=n;++i)
        scanf(&quot;%s&quot;,s),ACM::insert(s);
    ACM::prework();
    for(int i=1;i&lt;=m;++i)
        scanf(&quot;%s&quot;,t),printf(&quot;%d\n&quot;,ACM::solve(t));
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[[HAOI2009]æ±‚å›æ–‡ä¸² è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/haoi2009qiu-hui-wen-chuan-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/haoi2009qiu-hui-wen-chuan-jie-ti-bao-gao/">
        </link>
        <updated>2021-01-03T01:38:23.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™å®šé•¿åº¦ä¸º n çš„å­—ç¬¦ä¸² s ï¼Œæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»ä¸¤ä¸ªä½ç½®ã€‚æ±‚ä½¿å¾— s ä¸ºå›æ–‡ä¸²çš„æœ€å°äº¤æ¢æ¬¡æ•°ã€‚æ— è§£è¾“å‡º -1 ã€‚<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">n\leq 10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span>ï¼Œä¿è¯éƒ½æ˜¯å¤§å†™å­—æ¯</p>
<h2 id="solution">Solution</h2>
<p>æ— è§£çš„æƒ…å†µåˆ¤å®šï¼šè®¨è®º n çš„å¥‡å¶æ€§ä»¥åŠ s ä¸­å„å­—æ¯çš„å‡ºç°æ¬¡æ•°çš„å¥‡å¶æ€§å³å¯ã€‚</p>
<p>å¯¹äºâ€œæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»ä¸¤ä¸ªä½ç½®ï¼Œæ±‚æœ€å°äº¤æ¢æ¬¡æ•°â€çš„é¢˜ç›®ï¼Œé€šå¸¸é‡‡å–çš„åŠæ³•ä¸ºå¾—åˆ°ç›®æ ‡åºåˆ—ï¼Œå¹¶å®šä¹‰ las[i] è¡¨ç¤ºåˆå§‹åºåˆ—ä¸­çš„ç¬¬ i ä¸ªæ•°æœ€ç»ˆåº”åœ¨ç›®æ ‡åºåˆ—çš„ las[i] ä½ç½®ä¸Šã€‚ las æ•°ç»„çš„é€†åºå¯¹æ•°å³ä¸ºç­”æ¡ˆã€‚</p>
<p>é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£ç›®æ ‡åºåˆ—ã€‚å‡è®¾æˆ‘ä»¬åœ¨å¤„ç†å­—æ¯ x æ—¶é‡åˆ°äº†ä¸‹è¿°æƒ…å†µã€‚x çš„å‡ºç°ä½ç½®ä¸º a,b,c,d ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mo>â‹¯</mo></mrow><annotation encoding="application/x-tex">\cdots,a,\cdots,b,\cdots,c,\cdots,d,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span></span></span></span></p>
<p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬å›ºå®š a b ä¸å˜ï¼Œè®© d å»é€‚é… a çš„ä½ç½®ï¼Œc å»é€‚é… b çš„ä½ç½®ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚<br>
å‡è®¾æˆ‘ä»¬è®© c é€‚é… a ï¼Œd é€‚é… bï¼Œé‚£ä¹ˆæ— è®ºå¦‚ä½• c d éƒ½ä¼šç›¸é‡ä¸€æ¬¡ã€‚è€Œ c d æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸é‡ä¹‹åèµ°çš„è·ç¦»å®Œå…¨æ˜¯å¤šä½™çš„ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†é€‚é…åŒä¸€å­—æ¯çš„æ‰€æœ‰çš„ä½ç½®çš„æ–¹æ³•ã€‚</p>
<p>å¯¹äºä¸åŒçš„å­—æ¯å‘¢ï¼Ÿè€ƒè™‘ä¸‹è¿°æƒ…å†µï¼Œå…¶ä¸­ c d åˆ†åˆ«è¡¨ç¤º a b çš„å¯¹ç§°ä½ç½®ã€‚</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>c</mi><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mo>â‹¯</mo></mrow><annotation encoding="application/x-tex">\cdots,a,\cdots,b,\cdots,c,\cdots,d,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span></span></span></span></p>
<p>äº¤æ¢ a b çš„ä½ç½®æ˜¯å¦å¯ä»¥æ›´ä¼˜ï¼Ÿæˆ‘ä»¬è€ƒè™‘ a é€‚é…çš„ä½ç½®ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">p_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œb é€‚é…çš„ä½ç½®ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">p_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œæ˜¾ç„¶ï¼Œå½“ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>â‰¥</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">p_a\geq d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>b</mi></msub><mo>â‰¤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">p_b\leq c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> æ—¶ï¼Œå¯ä»¥ä½¿äº¤æ¢ a b çš„ä½ç½®åå‡å°‘çš„æ­¥æ•°æœ€å¤§åŒ–ï¼ˆå•è®ºæ­¥æ•°çš„å˜æ¢é‡è€Œè¨€çš„è¯ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¥</span></span></span></span> æˆ–è€… <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¤</mo></mrow><annotation encoding="application/x-tex">\leq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¤</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span></span></span></span> æ˜¯ç­‰æ•ˆçš„ï¼‰ã€‚ä½†æ˜¯ï¼Œå³ä½¿æ˜¯è¿™ç§æƒ…å†µä¸‹ï¼ˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>a</mi></msub><mo>=</mo><mi>d</mi><mo separator="true">,</mo><msub><mi>p</mi><mi>b</mi></msub><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">p_a=d,p_b=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span>ï¼‰ï¼Œäº¤æ¢ä¸å¦æ­¥æ•°ä¹Ÿåªæ˜¯æ°å¥½ç›¸ç­‰ã€‚æ•…å¯¹äºä¸¤ä¸ªä¸åŒçš„å­—æ¯ï¼Œä¸äº¤æ¢ä¸€å®šä¸åŠ£äºäº¤æ¢ã€‚</p>
<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è´ªå¿ƒåœ°æ„é€ å‡º las æ•°ç»„ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">if(num==1){
    for(int i=0;i&lt;26;++i) if(d[i]&amp;1){
        int now=p[i][p[i].size()/2];
        las[len+1&gt;&gt;1]=now;vis[now]=1;
    } 
}
int idx=1,nl=1,nr=len;
while(idx&lt;=len&amp;&amp;nl&lt;=nr){
    if(vis[idx]) {++idx;continue;}
    int mat=p[s[idx]].back();
    las[nl]=idx,las[nr]=mat,p[s[idx]].pop_back();
    ++nl,--nr,vis[mat]=1;++idx;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[PAM å­¦ä¹ ç¬”è®°]]></title>
        <id>https://parallelist-c.github.io/post/PAM-xue-xi-bi-ji/</id>
        <link href="https://parallelist-c.github.io/post/PAM-xue-xi-bi-ji/">
        </link>
        <updated>2021-01-02T02:54:21.000Z</updated>
        <content type="html"><![CDATA[<p>å›æ–‡è‡ªåŠ¨æœºï¼ˆPAMï¼‰æ˜¯é’ˆå¯¹ç»™å®šä¸²ï¼ŒåŒ…å«äº†è¯¥ä¸²æ‰€æœ‰å›æ–‡å­ä¸²çš„ä¿¡æ¯çš„è‡ªåŠ¨æœºã€‚<br>
PAM çš„æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨äº†ä¸€ä¸ªæœ¬è´¨ä¸åŒçš„å›æ–‡å­ä¸²ï¼Œè®° s[p] ä¸ºç‚¹ p ä»£è¡¨çš„å›æ–‡å­ä¸²ã€‚<br>
PAM çš„æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸‰ä¸ªåŸºç¡€å±æ€§ï¼šfail/len/child ã€‚<br>
lenï¼ša[p].len è¡¨ç¤º s[p] çš„é•¿åº¦ã€‚<br>
failï¼ša[p].fail è¿å‘äº†ç‚¹ x ï¼Œæ»¡è¶³ s[x] æ˜¯ s[p] çš„æœ€é•¿åç¼€å›æ–‡å­ä¸²ã€‚<br>
childï¼ša[p].child[v] è¿å‘äº†ç‚¹ x ï¼Œæ»¡è¶³ s[x] æ°æ˜¯ v+s[p]+v ã€‚å› æ­¤è½¬ç§»æ—¶ len ä¼šåŠ äºŒã€‚</p>
<p>ç”±äºå›æ–‡ä¸²æœ‰å¥‡å¶ä¹‹åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸¤ä¸ªæ ¹ï¼š-1 å’Œ 0 ï¼Œåˆ†åˆ«ä¸ºå¥‡æ ¹å’Œå¶æ ¹ã€‚å¥‡æ ¹çš„ len ä¸º -1 ï¼Œä»£è¡¨ -1 ä¸²ï¼ˆæ–¹ä¾¿æ’å…¥å•ä¸ªå­—ç¬¦æ„æˆçš„å›æ–‡ä¸²ï¼‰ï¼›å¶æ ¹çš„ len ä¸º 0 ï¼Œä»£è¡¨ç©ºä¸²ã€‚å¥‡æ ¹çš„ fail å¯ä»¥ä»»æ„è¿ï¼Œè€Œå¶æ ¹çš„ fail å®šä¹‰ä¸ºè¿å‘å¥‡æ ¹ã€‚</p>
<p>ç°åœ¨ç»™å®šå­—ç¬¦ä¸² t ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨å¢é‡æ³•æ¥æ„é€  PAM ã€‚<br>
å‡è®¾æ–°åŠ å…¥çš„ä½ç½®ä¸º v ï¼Œä¸Šä¸€ä¸ªæƒå€¼åŠ å…¥ååœ¨ SAM ä¸Šçš„ä½ç½®æ˜¯ las ã€‚v å¯ä»¥æ„æˆçš„å›æ–‡å­ä¸²å¯ä»¥è§†ä½œ t[v']+mid+t[v] çš„å½¢å¼ï¼Œå…¶ä¸­ mid éƒ¨åˆ†ä¹Ÿä¸ºå›æ–‡ä¸²ã€‚æ•…æˆ‘ä»¬ä» las å¼€å§‹ï¼Œè‹¥æ»¡è¶³ t[v]=t[v-a[las].len-1] ï¼Œæ„å‘³ç€æˆ‘ä»¬æ‰¾åˆ°äº†å¯¹åº”çš„æœ€å¤§å›æ–‡ä¸²ï¼›å¦åˆ™æ‰§è¡Œ las=a[las].fail å¹¶é‡æ–°æ£€éªŒã€‚å› ä¸º fail æŒ‡å‘çš„æ˜¯æœ€é•¿çš„åç¼€å›æ–‡å­ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…å®šä¼šç»è¿‡æ‰€æœ‰å¯èƒ½ã€‚<br>
å‡è®¾æˆ‘ä»¬æ‰¾åˆ°äº†æ»¡è¶³ t[v]=t[v-a[las].len-1] çš„ las ï¼Œæ­¤æ—¶æœ‰ä¸¤ç§å¯èƒ½ï¼š</p>
<ul>
<li>a[las].c[t[v]] å·²å­˜åœ¨ã€‚æ­¤æ—¶ v å¯¹äºä¸åŒç§ç±»çš„å›æ–‡å­ä¸²è€Œè¨€æ— ä»»ä½•è´¡çŒ®ã€‚</li>
<li>a[las].c[t[v]] æœªå­˜åœ¨ã€‚æ­¤æ—¶å‘ç°äº†æ–°çš„å›æ–‡å­ä¸²ã€‚æ–°å»ºèŠ‚ç‚¹å¹¶åˆå§‹åŒ–å…¶ len/fail å€¼å³å¯ã€‚</li>
</ul>
<p>æ„å»ºä»£ç ï¼š</p>
<pre><code class="language-cpp">namespace PAM{
    int s[N];
    int tot,las,top;
    struct PAM{
        int len,sum,fail,c[26];
    }a[N];
    void init(){
        tot=1,las=0,top=0;
        a[0].len=0,a[1].len=-1;
        a[0].fail=a[1].fail=1;
        memset(s,-1,sizeof s);
    }
    int getfail(int x,int p){
        while(s[p]!=s[p-a[x].len-1])
            x=a[x].fail;
        return x; 
    }
    void insert(int v){
        s[++top]=v;
        int cur=getfail(las,top);
        if(a[cur].c[v]==0){
            ++tot;
            a[tot].len=a[cur].len+2;
            a[tot].fail=a[getfail(a[cur].fail,top)].c[v];
            a[cur].c[v]=tot;
        }
        las=a[cur].c[v];
    }
}
</code></pre>
<p>æ¥ç€æ€»ç»“ä¸‹ PAM çš„ä¸€äº›åº”ç”¨ã€‚</p>
<p>æœ¬è´¨ä¸åŒçš„å›æ–‡ä¸²ä¸ªæ•°ï¼šè¿™ä¸ªæ˜¾ç„¶å°±æ˜¯ tot-1 ã€‚</p>
<p>å›æ–‡ä¸²çš„å‡ºç°æ¬¡æ•°ï¼šæ„å»º PAM æ—¶æˆ‘ä»¬åªç»Ÿè®¡äº†æé•¿çš„è¯¥å›æ–‡ä¸²çš„æ•°é‡ï¼Œä½†å…¶ä»–æƒ…å†µå¯ä»¥ä¸€å®šå¯ä»¥é€šè¿‡è·³ fail ç»Ÿè®¡åˆ°ã€‚è€ƒè™‘ insert(a[i]) åè‹¥æ–°å¢èŠ‚ç‚¹ä»£è¡¨çš„æ˜¯ s[j...i] ï¼Œé‚£ä¹ˆæ‰€æœ‰ä»¥ i ç»“å°¾çš„å›æ–‡å­ä¸²å¿…å®šæ˜¯ s[j...i] çš„åç¼€å­ä¸²ã€‚æ‹“æ‰‘æ’åºå dp å³å¯ã€‚</p>
<p>ä¸ PAM é…å¥—çš„æœ‰ä¸€ä¸ª trans æŒ‡é’ˆï¼Œå®šä¹‰ä¸ºæŒ‡å‘å°äºç­‰äºå½“å‰èŠ‚ç‚¹é•¿åº¦çš„ä¸€åŠçš„æœ€é•¿å›æ–‡åç¼€ã€‚<br>
æ±‚è§£ trans çš„æ–¹æ³•ä¸ fail ç±»ä¼¼ã€‚ä»çˆ¶èŠ‚ç‚¹çš„ trans å¼€å§‹æ£€éªŒï¼Œå¦‚æœå½“å‰å¹¶ä¸èƒ½æ„æˆå›æ–‡å­ä¸²/é•¿åº¦å¤§äºä¸€åŠï¼Œå°±ç»§ç»­è·³ fail ã€‚</p>
<p>PAM çš„æ‹“å±•æ€§æ²¡æœ‰ SAM å¼ºï¼Œä½†ä¹Ÿååˆ†çµæ´»ã€‚DFA è¿™ç§ä¸œè¥¿ï¼Œå¹³å¸¸ä¸€å®šè¦å¤šåŠ æ·±ç†è§£å•Š ğŸ‘Š ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Query on a tree VI è§£é¢˜æŠ¥å‘Š]]></title>
        <id>https://parallelist-c.github.io/post/query-on-a-tree-vi-jie-ti-bao-gao/</id>
        <link href="https://parallelist-c.github.io/post/query-on-a-tree-vi-jie-ti-bao-gao/">
        </link>
        <updated>2020-12-29T12:06:33.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p>ç»™ä½ ä¸€æ£µ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> ä¸ªç‚¹çš„æ ‘ï¼Œæ¯ä¸ªç‚¹ä¸ºé»‘è‰²æˆ–ç™½è‰²ã€‚è¦æ±‚ç»´æŠ¤ä¸¤ä¸ªæ“ä½œï¼š</p>
<ul>
<li>æ”¹å˜ç‚¹ u çš„é¢œè‰²</li>
<li>æŸ¥è¯¢åŒ…å«ç‚¹ u çš„åŒè‰²è¿é€šå—å¤§å°</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>q</mi><mo>â‰¤</mo><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">n,q\leq 10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solution">Solution</h2>
<p>åŠ¨æ€ç»´æŠ¤è¿é€šå—å¯ä»¥è€ƒè™‘ LCT ã€‚ä½†æ˜¯å½“ä¸€ä¸ªç‚¹é¢œè‰²æ”¹å˜æ—¶å¦‚æœæˆ‘ä»¬æšä¸¾å…¶æ‰€æœ‰å‡ºè¾¹æ¥æ›´æ”¹ï¼Œå¤æ‚åº¦çˆ†ç‚¸ã€‚</p>
<p>å¹³å¸¸éƒ½æ˜¯æŠŠè¾¹çš„ä¿¡æ¯æ”¾åœ¨ç‚¹ä¸Šï¼Œå› ä¸ºè¾¹æ•°æ¯”ç‚¹æ•°å°‘ï¼Œä¿¡æ¯ä¸€å®šä¸ä¼šæœ‰ç¼ºå¤±ï¼›å¾ˆå°‘æŠŠç‚¹çš„ä¿¡æ¯æ”¾åœ¨è¾¹ä¸Šã€‚<br>
å®é™…ä¸Šï¼Œç‚¹çš„ä¿¡æ¯ä¹Ÿæ˜¯å¯ä»¥æ”¾åœ¨è¾¹ä¸Šçš„ã€‚å¯¹äºéæ ¹èŠ‚ç‚¹ï¼Œæ¯ä¸ªç‚¹çš„ä¿¡æ¯æ”¾åœ¨çˆ¶è¾¹ä¸Šï¼›å¯¹äºæ ¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¦å¼€ä¸€ä¸ªè™šæ‹Ÿæ ¹èŠ‚ç‚¹ä¸å…¶è¿è¾¹ç”¨æ¥å­˜æ ¹èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚</p>
<p>å…·ä½“äºæœ¬é¢˜è€Œè¨€ï¼Œæˆ‘ä»¬å»ºä¸¤æ£µ LCT ï¼Œåˆ†åˆ«ä»£è¡¨é»‘/ç™½è‰²ã€‚åœ¨ LCT ä¸­ï¼Œæˆ‘ä»¬åªåŠ å…¥å¯¹åº”é¢œè‰²çš„è¾¹ã€‚ç‚¹ u åœ¨é¢œè‰² c[u] å¯¹åº”çš„ LCT ä¸Šçš„æœ€è¿œç¥–å…ˆä¸€å®šæ˜¯è™šæ‹ŸèŠ‚ç‚¹/å¼‚è‰²èŠ‚ç‚¹ï¼Œå³ findroot(u) åï¼Œæ ¹çš„é‡å­æ ‘å¤§å°å°±æ˜¯åŒ…å«ç‚¹ u çš„åŒè‰²è¿é€šå—å¤§å°ï¼ˆå› ä¸º findroot ä¸­ splay äº†æ ¹èŠ‚ç‚¹ï¼‰ã€‚æ ¹çš„é‡å„¿å­å¿…å®šæ˜¯å…¶å³å„¿å­ã€‚</p>
<p>é—®é¢˜è½¬åŒ–ä¸ºç»´æŠ¤ LCT ä¸Š u çš„å­æ ‘å¤§å°ï¼Œç»´æŠ¤ä¸€ä¸ª vir[u] è¡¨ç¤ºè¿å‘ u çš„æ‰€æœ‰è½»é“¾ size å³å¯ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æœ¬é¢˜ä¸­ï¼Œæ ‘çš„å½¢æ€æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½è¿›è¡Œ makeroot æ“ä½œã€‚ä½†åº†å¹¸çš„æ˜¯ï¼Œç»è¿‡ä¸Šè¿°åˆ†æåï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° link å’Œ cut æ“ä½œéƒ½æ˜¯æ°å¥½é’ˆå¯¹ç‚¹ u å’Œå…¶çˆ¶èŠ‚ç‚¹æ¥çš„ï¼Œæ•…ä»ç„¶å¯ä»¥å®ç°ã€‚</p>
<h2 id="code">Code</h2>
<pre><code class="language-cpp">struct LCT{
#define lc(x) c[x][0]
#define rc(x) c[x][1]
    int sz[N],fa[N],vir[N],c[N][2];
    LCT(){for(int i=1;i&lt;N;++i) sz[i]=1;}
    inline void update(int x){
        sz[x]=sz[lc(x)]+sz[rc(x)]+vir[x]+1;
    }
    inline bool isrt(int x){
        return fa[x]==0 || (lc(fa[x])!=x&amp;&amp;rc(fa[x])!=x);
    }
    inline void rotate(int x){
        int y=fa[x],z=fa[y],t=rc(y)==x;
        if(!isrt(y)) c[z][rc(z)==y]=x;fa[x]=z;
        c[y][t]=c[x][t^1];fa[c[x][t^1]]=y;
        c[x][t^1]=y;fa[y]=x;
        update(y),update(x);
    }
    void splay(int x){
        while(!isrt(x)){
            int y=fa[x],z=fa[y];
            if(!isrt(y))
                ((rc(y)==x)^(rc(z)==y))?rotate(x):rotate(y);
            rotate(x);
        }
    }
    void access(int x){
        for(int i=0;x;x=fa[i=x])
            splay(x),vir[x]+=sz[rc(x)],rc(x)=i,vir[x]-=sz[i],update(x);
    }
    int findrt(int x){                          
        access(x);splay(x);
        while(lc(x)) 
            x=lc(x);
        splay(x);
        return x;
    }
    void link(int x,int y){
        splay(x);fa[x]=y;
        access(y),splay(y);
        vir[y]+=sz[x];sz[y]+=sz[x];
    }
    void cut(int x,int y){
        access(x),splay(x),lc(x)=fa[lc(x)]=0;update(x);
    }
}t[2];
</code></pre>
]]></content>
    </entry>
</feed>